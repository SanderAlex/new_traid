function eli18n(e){this.textdomain=function(e){return this.messages[e]?this._domain=e:this._domain},e&&e.messages&&this.load(e.messages),e&&e.textdomain&&this.textdomain(e.textdomain)}function elDialogForm(e){var t=this,n={"class":"el-dialogform",submit:function(e,t){t.close()},form:{action:window.location.href,method:"post"},ajaxForm:null,validate:null,spinner:"Loading",tabs:{active:0,selected:0},tabPrefix:"el-df-tab-",dialog:{title:"dialog",autoOpen:!1,modal:!0,resizable:!1,closeOnEscape:!0,buttons:{Cancel:function(){t.close()},Ok:function(){t.form.trigger("submit")}}}};this.opts=jQuery.extend(!0,{},n,e),this.opts.dialog.close=function(){t.close()},this.opts.rtl&&(this.opts["class"]+=" el-dialogform-rtl"),e&&e.dialog&&e.dialog.buttons&&typeof e.dialog.buttons=="object"&&(this.opts.dialog.buttons=e.dialog.buttons),this.ul=null,this.tabs={},this._table=null,this.dialog=jQuery("<div />").addClass(this.opts["class"]).dialog(this.opts.dialog),this.message=jQuery('<div class="el-dialogform-message rounded-5" />').hide().appendTo(this.dialog),this.error=jQuery('<div class="el-dialogform-error rounded-5" />').hide().appendTo(this.dialog),this.spinner=jQuery('<div class="spinner" />').hide().appendTo(this.dialog),this.content=jQuery('<div class="el-dialogform-content" />').appendTo(this.dialog),this.form=jQuery("<form />").attr(this.opts.form).appendTo(this.content),this.opts.submit&&this.form.bind("submit",function(e){t.opts.submit(e,t)}),this.opts.ajaxForm&&jQuery.fn.ajaxForm&&this.form.ajaxForm(this.opts.ajaxForm),this.opts.validate&&this.form.validate(this.opts.validate),this.option=function(e,t){return this.dialog.dialog("option",e,t)},this.showError=function(e,t){return this.hideMessage(),this.hideSpinner(),this.error.html(e).show(),t&&this.content.hide(),this},this.hideError=function(){return this.error.text("").hide(),this.content.show(),this},this.showSpinner=function(e){return this.error.hide(),this.message.hide(),this.content.hide(),this.spinner.text(e||this.opts.spinner).show(),this.option("buttons",{}),this},this.hideSpinner=function(){return this.content.show(),this.spinner.hide(),this},this.showMessage=function(e,t){return this.hideError(),this.hideSpinner(),this.message.html(e||"").show(),t&&this.content.hide(),this},this.hideMessage=function(){return this.message.hide(),this.content.show(),this},this.tab=function(e,t){return e=this.opts.tabPrefix+e,this.ul||(this.ul=jQuery("<ul />").prependTo(this.form)),jQuery("<li />").append(jQuery("<a />").attr("href","#"+e).html(t)).appendTo(this.ul),this.tabs[e]={tab:jQuery("<div />").attr("id",e).addClass("tab").appendTo(this.form),table:null},this},this.table=function(e){return e=e&&e.indexOf(this.opts.tabPrefix)==-1?this.opts.tabPrefix+e:e,e&&this.tabs&&this.tabs[e]?this.tabs[e].table=jQuery("<table />").appendTo(this.tabs[e].tab):this._table=jQuery("<table />").appendTo(this.form),this},this.append=function(e,t,n){t=t?"el-df-tab-"+t:"";if(!e)return this;if(t&&this.tabs[t])if(n){!this.tabs[t].table&&this.table(t);var r=jQuery("<tr />").appendTo(this.tabs[t].table);if(!jQuery.isArray(e))r.append(jQuery("<td />").append(e));else for(var i=0;i<e.length;i++)r.append(jQuery("<td />").append(e[i]))}else if(!jQuery.isArray(e))this.tabs[t].tab.append(e);else for(var i=0;i<e.length;i++)this.tabs[t].tab.append(e[i]);else if(!n)if(!jQuery.isArray(e))this.form.append(e);else for(var i=0;i<e.length;i++)this.form.append(e[i]);else{this._table||this.table();var r=jQuery("<tr />").appendTo(this._table);if(!jQuery.isArray(e))r.append(jQuery("<td />").append(e));else for(var i=0;i<e.length;i++)r.append(jQuery("<td />").append(e[i]))}return this},this.separator=function(e){return e="el-df-tab-"+e,this.tabs&&this.tabs[e]?(this.tabs[e].tab.append(jQuery("<div />").addClass("separator")),this.tabs[e].table&&this.table(e)):this.form.append(jQuery("<div />").addClass("separator")),this},this.open=function(){var e=this;return this.ul&&this.form.tabs(this.opts.tabs),setTimeout(function(){e.dialog.find(":text").keydown(function(t){t.keyCode==13&&(t.preventDefault(),e.form.submit())}).first().focus()},200),this.dialog.dialog("open"),this},this.close=function(){typeof this.opts.close=="function"&&this.opts.close(),this.dialog.dialog("destroy")}}eli18n.prototype=new function(){this.messages={},this._domain="",this.load=function(e){if(typeof e=="object")for(var t in e){var n=e[t];if(typeof n=="object"){this.messages[t]||(this.messages[t]={});for(var r in n)typeof n[r]=="string"&&(this.messages[t][r]=n[r])}}return this},this.translate=function(e,t){var t=t&&this.messages[t]?t:this._domain;return this.messages[t]&&this.messages[t][e]?this.messages[t][e]:e},this.format=function(e,t,n){e=this.translate(e,n);if(typeof t=="object")for(var r in t)e=e.replace("%"+r,this.translate(t[r],n));return e}},function(e){e.fn.elColorPicker=function(t){function i(e){n.val(e),r.change&&r.change(n.val()),n.palette.slideUp()}function s(){n.palette=e("<div />").addClass(r.paletteClass+" rounded-3");for(var t=0;t<r.colors.length;t++)e("<div />").addClass("color").css("background-color",r.colors[t]).attr({title:r.colors[t],unselectable:"on"}).appendTo(n.palette).mouseenter(function(){var t=e(this).attr("title");n.input.val(t),n.preview.css("background-color",t)}).click(function(t){t.stopPropagation(),i(e(this).attr("title"))});n.input=e('<input type="text" />').addClass("rounded-3").attr("size",8).click(function(t){t.stopPropagation(),e(this).focus()}).keydown(function(t){if(t.ctrlKey||t.metaKey)return!0;var r=t.keyCode;if(r==27)return n.mouseleave();if(r!=8&&r!=13&&r!=46&&r!=37&&r!=39&&(r<48||r>57)&&(r<65||r>70))return!1;var s=e(this).val();if(s.length==7||s.length==0){r==13&&(t.stopPropagation(),t.preventDefault(),i(s),n.palette.slideUp());if(t.keyCode!=8&&t.keyCode!=46&&r!=37&&r!=39)return!1}}).keyup(function(t){var r=e(this).val();r.length==7&&/^#[0-9abcdef]{6}$/i.test(r)&&n.val(r)}),n.preview=e("<div />").addClass("preview rounded-3").click(function(e){e.stopPropagation(),i(n.input.val())}),n.palette.append(e("<div />").addClass("clearfix")).append(e("<div />").addClass("panel").append(n.input).append(n.preview)),r.palettePosition=="outer"?(n.palette.hide().appendTo(n.parents("body").eq(0)).mouseleave(function(){n.palette.is(":animated")||(e(this).slideUp(),n.val(n.val()))}),n.mouseleave(function(e){e.relatedTarget!=n.palette.get(0)&&(n.palette.is(":animated")||(n.palette.slideUp(),n.val(n.val())))})):n.append(n.palette.hide()).mouseleave(function(e){n.palette.slideUp(),n.val(n.val())}),n.val(n.val())}var n=this,r=e.extend({},e.fn.elColorPicker.defaults,t);return this.hidden=e('<input type="hidden" />').attr("name",r.name).val(r.color||"").appendTo(this),this.palette=null,this.preview=null,this.input=null,this.empty().addClass(r["class"]+" rounded-3").css({position:"relative","background-color":r.color||""}).click(function(t){if(!n.hasClass("disabled")){!n.palette&&s();if(r.palettePosition=="outer"&&n.palette.css("display")=="none"){var i=e(this).offset(),o=n.palette.width(),u=n.parents("body").width()-i.left>=o?i.left:i.left+e(this).outerWidth()-o;n.palette.css({left:u+"px",top:i.top+e(this).height()+1+"px"})}n.palette.slideToggle()}}),this.val=function(e){return!e&&e!==""?this.hidden.val():(this.hidden.val(e),r.update?r.update(this.hidden.val()):this.css("background-color",e),n.palette&&(n.preview.css("background-color",e),n.input.val(e)),this)},this},e.fn.elColorPicker.defaults={"class":"el-colorpicker",paletteClass:"el-palette",palettePosition:"inner",name:"color",color:"",update:null,change:function(e){},colors:["#ffffff","#cccccc","#999999","#666666","#333333","#000000","#ffcccc","#cc9999","#996666","#663333","#330000","#ff9999","#cc6666","#cc3333","#993333","#660000","#ff6666","#ff3333","#ff0000","#cc0000","#990000","#ff9966","#ff6633","#ff3300","#cc3300","#993300","#ffcc99","#cc9966","#cc6633","#996633","#663300","#ff9933","#ff6600","#ff9900","#cc6600","#cc9933","#ffcc66","#ffcc33","#ffcc00","#cc9900","#996600","#ffffcc","#cccc99","#999966","#666633","#333300","#ffff99","#cccc66","#cccc33","#999933","#666600","#ffff66","#ffff33","#ffff00","#cccc00","#999900","#ccff66","#ccff33","#ccff00","#99cc00","#669900","#ccff99","#99cc66","#99cc33","#669933","#336600","#99ff33","#99ff00","#66ff00","#66cc00","#66cc33","#99ff66","#66ff33","#33ff00","#33cc00","#339900","#ccffcc","#99cc99","#669966","#336633","#003300","#99ff99","#66cc66","#33cc33","#339933","#006600","#66ff66","#33ff33","#00ff00","#00cc00","#009900","#66ff99","#33ff66","#00ff33","#00cc33","#009933","#99ffcc","#66cc99","#33cc66","#339966","#006633","#33ff99","#00ff66","#00ff99","#00cc66","#33cc99","#66ffcc","#33ffcc","#00ffcc","#00cc99","#009966","#ccffff","#99cccc","#669999","#336666","#003333","#99ffff","#66cccc","#33cccc","#339999","#006666","#66cccc","#33ffff","#00ffff","#00cccc","#009999","#66ccff","#33ccff","#00ccff","#0099cc","#006699","#99ccff","#6699cc","#3399cc","#336699","#003366","#3399ff","#0099ff","#0066ff","#066ccc","#3366cc","#6699ff","#3366ff","#0033ff","#0033cc","#003399","#ccccff","#9999cc","#666699","#333366","#000033","#9999ff","#6666cc","#3333cc","#333399","#000066","#6666ff","#3333ff","#0000ff","#0000cc","#009999","#9966ff","#6633ff","#3300ff","#3300cc","#330099","#cc99ff","#9966cc","#6633cc","#663399","#330066","#9933ff","#6600ff","#9900ff","#6600cc","#9933cc","#cc66ff","#cc33ff","#cc00ff","#9900cc","#660099","#ffccff","#cc99cc","#996699","#663366","#330033","#ff99ff","#cc66cc","#cc33cc","#993399","#660066","#ff66ff","#ff33ff","#ff00ff","#cc00cc","#990099","#ff66cc","#ff33cc","#ff00cc","#cc0099","#990066","#ff99cc","#cc6699","#cc3399","#993366","#660033","#ff3399","#ff0099","#ff0066","#cc0066","#cc3366","#ff6699","#ff3366","#ff0033","#cc0033","#990033"]}}(jQuery),function(e){e.fn.elBorderSelect=function(t){function f(e){function t(e){return hexDigits=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],e?hexDigits[(e-e%16)/16]+hexDigits[e%16]:"00"}var n=(e||"").match(/\(([0-9]{1,3}),\s*([0-9]{1,3}),\s*([0-9]{1,3})\)/);return n?"#"+t(n[1])+t(n[2])+t(n[3]):""}function l(t){if(!t)return t;var n=t.match(/([0-9]+\.?[0-9]*)\s*(px|pt|em|%)/);n&&(t=n[1],unit=n[2]),t[0]=="."&&(t="0"+t),t=parseFloat(t);if(isNaN(t))return"";var r=parseInt(e(document.body).css("font-size"))||16;switch(unit){case"em":return parseInt(t*r);case"pt":return parseInt(t*r/12);case"%":return parseInt(t*r/100)}return t}var n=this,r=this.eq(0),i=e.extend({},e.fn.elBorderSelect.defaults,t),s=e('<input type="text" />').attr({name:i.name+"[width]",size:3}).css("text-align","right").change(function(){n.change()}),o=e("<div />").css("position","relative").elColorPicker({"class":"el-colorpicker ui-icon ui-icon-pencil",name:i.name+"[color]",palettePosition:"outer",change:function(){n.change()}}),u=e("<div />").elSelect({tpl:'<div style="border-bottom:4px %val #000;width:100%;margin:7px 0"> </div>',tpls:{"":"%label"},maxHeight:i.styleHeight||null,select:function(){n.change()},src:{"":"none",solid:"solid",dashed:"dashed",dotted:"dotted","double":"double",groove:"groove",ridge:"ridge",inset:"inset",outset:"outset"}});return r.empty().addClass(i["class"]).attr("name",i.name||"").append(e("<table />").attr("cellspacing",0).append(e("<tr />").append(e("<td />").append(s).append(" px")).append(e("<td />").append(u)).append(e("<td />").append(o)))),this.change=function(){i.change&&i.change(this.val())},this.val=function(t){var n,r,i,h,d;return!t&&t!==""?(n=parseInt(s.val()),n=isNaN(n)?"":n+"px",r=u.val(),i=o.val(),{width:n,style:r,color:i,css:e.trim(n+" "+r+" "+i)}):(h="",t.nodeName||t.css?(t.css||(t=e(t)),h=t.css("border"),(h=t.css("border"))?n=r=i=h:(n=t.css("border-width"),r=t.css("border-style"),i=t.css("border-color"))):(n=t.width||"",r=t.style||"",i=t.color||""),s.val(l(n)),d=r?r.match(/(solid|dashed|dotted|double|groove|ridge|inset|outset)/i):"",u.val(d?d[1]:""),o.val(i.indexOf("#")===0?i:f(i)),this)},this.val(i.value),this},e.fn.elBorderSelect.defaults={name:"el-borderselect","class":"el-borderselect",value:{},change:null}}(jQuery),function(e){e.fn.elPaddingInput=function(t){function s(t){return t=e.trim(t.toString()),t[0]=="."&&(t="0"+t),n=parseFloat(t),isNaN(n)?t=="auto"?t:"":n}function o(){i.change&&i.change(r)}var r=this,i=e.extend({},e.fn.elPaddingInput.defaults,{name:this.attr("name")},t);return this.regexps={main:new RegExp(i.type=="padding"?'paddings*:s*([^;"]+)':'margins*:s*([^;"]+)',"im"),left:new RegExp(i.type=="padding"?'padding-lefts*:s*([^;"]+)':'margin-lefts*:s*([^;"]+)',"im"),top:new RegExp(i.type=="padding"?'padding-tops*:s*([^;"]+)':'margin-tops*:s*([^;"]+)',"im"),right:new RegExp(i.type=="padding"?'padding-rights*:s*([^;"]+)':'margin-rights*:s*([^;"]+)',"im"),bottom:new RegExp(i.type=="padding"?'padding-bottoms*:s*([^;"]+)':'margin-bottoms*:s*([^;"]+)',"im")},e.each(["left","top","right","bottom"],function(){r[this]=e('<input type="text" />').attr("size",3).css("text-align","right").css("border-"+this,"2px solid red").bind("change",function(){e(this).val(s(e(this).val())),o()}).attr("name",i.name+"["+this+"]")}),e.each(["uleft","utop","uright","ubottom"],function(){r[this]=e("<select />").append('<option value="px">px</option>').append('<option value="em">em</option>').append('<option value="pt">pt</option>').bind("change",function(){o()}).attr("name",i.name+"["+this+"]"),i.percents&&r[this].append('<option value="%">%</option>')}),this.empty().addClass(i["class"]).append(this.left).append(this.uleft).append(" x ").append(this.top).append(this.utop).append(" x ").append(this.right).append(this.uright).append(" x ").append(this.bottom).append(this.ubottom),this.val=function(t){if(!t&&t!==""){var n=s(this.left.val()),i=s(this.top.val()),o=s(this.right.val()),u=s(this.bottom.val()),f={left:n=="auto"||n==0?n:n!==""?n+this.uleft.val():"",top:i=="auto"||i==0?i:i!==""?i+this.utop.val():"",right:o=="auto"||o==0?o:o!==""?o+this.uright.val():"",bottom:u=="auto"||u==0?u:u!==""?u+this.ubottom.val():"",css:""};return f.left!==""&&f.right!==""&&f.top!==""&&f.bottom!==""&&(f.left==f.right&&f.top==f.bottom?f.css=f.top+" "+f.left:f.css=f.top+" "+f.right+" "+f.bottom+" "+f.left),f}if(t.nodeName||t.css){t.css||(t=e(t));var l={left:"",top:"",right:"",bottom:""},h=(t.attr("style")||"").toLowerCase();if(h){h=e.trim(h);var p=h.match(this.regexps.main);if(p){var d=e.trim(p[1]).replace(/\s+/g," ").split(" ",4);l.top=d[0],l.right=d[1]&&d[1]!==""?d[1]:l.top,l.bottom=d[2]&&d[2]!==""?d[2]:l.top,l.left=d[3]&&d[3]!==""?d[3]:l.right}else e.each(["left","top","right","bottom"],function(){var e=this.toString();p=h.match(r.regexps[e]),p&&(l[e]=p[1])})}var t=l}return e.each(["left","top","right","bottom"],function(){var e=this.toString();r[e].val(""),r["u"+e].val();if(typeof t[e]!="undefined"&&t[e]!==null){t[e]=t[e].toString();var n=s(t[e]);r[e].val(n);var i=t[e].match(/(px|em|pt|%)/i);r["u"+e].val(i?i[1]:"px")}}),this},this.val(i.value),this},e.fn.elPaddingInput.defaults={name:"el-paddinginput","class":"el-paddinginput",type:"padding",value:{},percents:!0,change:null}}(jQuery),function(e){e.fn.elSelect=function(t){function h(e){var t=i.labelTpl||i.tpls[e]||i.tpl;o.html(t.replace(/%val/g,e).replace(/%label/,i.src[e])).children().attr({unselectable:"on"})}function p(){u=e("<div />").addClass(i.listClass+" rounded-3").hide().appendTo(r.mouseleave(function(e){u.slideUp()}));for(var t in i.src){var o=i.tpls[t]||i.tpl;e("<div />").attr("name",t).append(e(o.replace(/%val/g,t).replace(/%label/g,i.src[t])).attr({unselectable:"on"})).appendTo(u).hover(function(){e(this).addClass("hover")},function(){e(this).removeClass("hover")}).click(function(t){t.stopPropagation(),t.preventDefault();var r=e(this).attr("name");n.val(r),i.select(r),u.slideUp()})}var f=r.outerWidth();u.width()<f&&u.width(f);var l=u.height();i.maxHeight>0&&l>i.maxHeight&&u.height(i.maxHeight),n.val(s.val())}var n=this,r=this.eq(0),i=e.extend({},e.fn.elSelect.defaults,t),s=e('<input type="hidden" />').attr("name",i.name),o=e("<label />").attr({unselectable:"on"}).addClass("rounded-left-3"),u=null,f=null;r.get(0).nodeName=="SELECT"&&(i.src={},r.children("option").each(function(){i.src[e(this).val()]=e(this).text()}),i.value=r.val(),i.name=r.attr("name"),r.replaceWith(r=e("<div />")));if(!i.value||!i.src[i.val]){i.value=null;var l=0;for(var c in i.src)l++==0&&(i.value=c)}return this.val=function(t){return!t&&t!==""?s.val():(i.src[t]&&(s.val(t),h(t),u&&u.children().each(function(){e(this).attr("name")==t?e(this).addClass("active"):e(this).removeClass("active")})),this)},r.empty().addClass(i["class"]+" rounded-3").attr({unselectable:"on"}).append(s).append(o).hover(function(){e(this).addClass("hover")},function(){e(this).removeClass("hover")}).click(function(t){!u&&p(),u.slideToggle(),e.browser.msie&&!f&&(u.children().each(function(){f=Math.max(f,e(this).width())}),f>u.width()&&u.width(f+40))}),this.val(i.value),this},e.fn.elSelect.defaults={name:"el-select","class":"el-select",listClass:"list",labelTpl:null,tpl:"<%val>%label</%val>",tpls:{},value:null,src:{},select:function(e){window.console&&window.console.log&&window.console.log("selected: "+e)},maxHeight:410}}(jQuery),function(e){elRTE=function(t,n){if(!t||!t.nodeName)return alert('elRTE: argument "target" is not DOM Element');var r=this,i;this.version="1.3",this.build="2011-06-23",this.options=e.extend(!0,{},this.options,n),this.browser=e.browser,this.target=e(t),this.lang=""+this.options.lang,this._i18n=new eli18n({textdomain:"rte",messages:{rte:this.i18Messages[this.lang]||{}}}),this.rtl=!!/^(ar|fa|he)$/.test(this.lang)&&!!this.i18Messages[this.lang],this.rtl&&(this.options.cssClass+=" el-rte-rtl"),this.toolbar=e('<div class="toolbar"/>'),this.iframe=document.createElement("iframe"),this.iframe.setAttribute("frameborder",0),this.workzone=e('<div class="workzone"/>').append(this.iframe).append(this.source),this.statusbar=e('<div class="statusbar"/>'),this.tabsbar=e('<div class="tabsbar"/>'),this.editor=e('<div class="'+this.options.cssClass+'" />').append(this.toolbar).append(this.workzone).append(this.statusbar).append(this.tabsbar),this.doc=null,this.$doc=null,this.window=null,this.utils=new this.utils(this),this.dom=new this.dom(this),this.filter=new this.filter(this),this.updateHeight=function(){r.workzone.add(r.iframe).add(r.source).height(r.workzone.height())},this.resizable=function(t){var n=this;this.options.resizable&&e.fn.resizable&&(t?this.editor.resizable({handles:"se",alsoResize:this.workzone,minWidth:300,minHeight:200}).bind("resize",n.updateHeight):this.editor.resizable("destroy").unbind("resize",n.updateHeight))},this.editor.insertAfter(t);var s="";t.nodeName=="TEXTAREA"?(this.source=this.target,this.source.insertAfter(this.iframe).hide(),s=this.target.val()):(this.source=e("<textarea />").insertAfter(this.iframe).hide(),s=this.target.hide().html()),this.source.attr("name",this.target.attr("name")||this.target.attr("id")),s=e.trim(s),s||(s=" "),this.options.allowSource&&this.tabsbar.append('<div class="tab editor rounded-bottom-7 active">'+r.i18n("Editor")+'</div><div class="tab source rounded-bottom-7">'+r.i18n("Source")+'</div><div class="clearfix" style="clear:both"/>').children(".tab").click(function(t){e(this).hasClass("active")||(r.tabsbar.children(".tab").toggleClass("active"),r.workzone.children().toggle(),e(this).hasClass("editor")?(r.updateEditor(),r.window.focus(),r.ui.update(!0)):(r.updateSource(),r.source.focus(),e.browser.msie||r.source[0].setSelectionRange(0,0),r.ui.disable(),r.statusbar.empty()))}),this.window=this.iframe.contentWindow,this.doc=this.iframe.contentWindow.document,this.$doc=e(this.doc),i='<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />',e.each(r.options.cssfiles,function(){i+='<link rel="stylesheet" type="text/css" href="'+this+'" />'}),this.doc.open();var o=this.filter.wysiwyg(s),u=this.rtl?' class="el-rte-rtl"':"";this.doc.write(r.options.doctype+i+"</head><body"+u+">"+o+"</body></html>"),this.doc.close();if(e.browser.msie)this.doc.body.contentEditable=!0;else{try{this.doc.designMode="on"}catch(f){}this.doc.execCommand("styleWithCSS",!1,this.options.styleWithCSS)}this.options.height>0&&this.workzone.height(this.options.height),this.options.width>0&&this.editor.width(this.options.width),this.updateHeight(),this.resizable(!0),this.window.focus(),this.history=new this.history(this),this.selection=new this.selection(this),this.ui=new this.ui(this),this.target.parents("form").bind("submit.elfinder",function(e){r.source.parents("form").find('[name="el-select"]').remove(),r.beforeSave()}),this.source.bind("keydown",function(t){if(t.keyCode==9){t.preventDefault();if(e.browser.msie){var n=document.selection.createRange();n.text="	"+n.text,this.focus()}else{var r=this.value.substr(0,this.selectionStart),i=this.value.substr(this.selectionEnd);this.value=r+"	"+i,this.setSelectionRange(r.length+1,r.length+1)}}}),e(this.doc.body).bind("dragend",function(e){setTimeout(function(){try{r.window.focus();var e=r.selection.getBookmark();r.selection.moveToBookmark(e),r.ui.update()}catch(t){}},200)}),this.typing=!1,this.lastKey=null,this.$doc.bind("mouseup",function(){r.typing=!1,r.lastKey=null,r.ui.update()}).bind("keyup",function(e){(e.keyCode>=8&&e.keyCode<=13||e.keyCode>=32&&e.keyCode<=40||e.keyCode==46||e.keyCode>=96&&e.keyCode<=111)&&r.ui.update()}).bind("keydown",function(t){if((t.metaKey||t.ctrlKey)&&t.keyCode==65)r.ui.update();else if(t.keyCode==13){var n=r.selection.getNode();if(r.dom.selfOrParent(n,/^PRE$/))return r.selection.insertNode(r.doc.createTextNode("\r\n")),!1;if(e.browser.safari&&t.shiftKey)return r.selection.insertNode(r.doc.createElement("br")),!1}if(t.keyCode>=48&&t.keyCode<=57||t.keyCode==61||t.keyCode==109||t.keyCode>=65&&t.keyCode<=90||t.keyCode==188||t.keyCode==190||t.keyCode==191||t.keyCode>=219&&t.keyCode<=222)r.typing||r.history.add(!0),r.typing=!0,r.lastKey=null;else if(t.keyCode==8||t.keyCode==46||t.keyCode==32||t.keyCode==13)t.keyCode!=r.lastKey&&r.history.add(!0),r.lastKey=t.keyCode,r.typing=!1;if(t.keyCode==32&&e.browser.opera)return r.selection.insertNode(r.doc.createTextNode(" ")),!1}).bind("paste",function(t){if(!r.options.allowPaste)t.stopPropagation(),t.preventDefault();else{var n=e(r.dom.create("div"))[0],i=r.doc.createTextNode("_");r.history.add(!0),r.typing=!0,r.lastKey=null,n.appendChild(i),r.selection.deleteContents().insertNode(n),r.selection.select(i),setTimeout(function(){n.parentNode?(e(n).html(r.filter.proccess("paste",e(n).html())),i=n.lastChild,r.dom.unwrap(n),i&&(r.selection.select(i),r.selection.collapse(!1))):(n.parentNode&&n.parentNode.removeChild(n),r.val(r.filter.proccess("paste",r.filter.wysiwyg2wysiwyg(e(r.doc.body).html()))),r.selection.select(r.doc.body.firstChild),r.selection.collapse(!0)),e(r.doc.body).mouseup()},15)}}),e.browser.msie&&this.$doc.bind("keyup",function(t){t.keyCode==86&&(t.metaKey||t.ctrlKey)&&(r.history.add(!0),r.typing=!0,r.lastKey=null,r.selection.saveIERange(),r.val(r.filter.proccess("paste",r.filter.wysiwyg2wysiwyg(e(r.doc.body).html()))),r.selection.restoreIERange(),e(r.doc.body).mouseup(),this.ui.update())}),e.browser.safari&&this.$doc.bind("click",function(t){e(r.doc.body).find(".elrte-webkit-hl").removeClass("elrte-webkit-hl"),t.target.nodeName=="IMG"&&e(t.target).addClass("elrte-webkit-hl")}).bind("keyup",function(t){e(r.doc.body).find(".elrte-webkit-hl").removeClass("elrte-webkit-hl")}),this.window.focus(),this.destroy=function(){this.updateSource(),this.target.is("textarea")?this.target.val(e.trim(this.source.val())):this.target.html(e.trim(this.source.val())),this.editor.remove(),this.target.show().parents("form").unbind("submit.elfinder")}},elRTE.prototype.i18n=function(e){return this._i18n.translate(e)},elRTE.prototype.open=function(){this.editor.show()},elRTE.prototype.close=function(){this.editor.hide()},elRTE.prototype.updateEditor=function(){this.val(this.source.val())},elRTE.prototype.updateSource=function(){this.source.val(this.filter.source(e(this.doc.body).html()))},elRTE.prototype.val=function(t){if(typeof t!="string")return this.source.is(":visible")?$.trim(this.filter.source2source(this.source.val())):$.trim(this.filter.source(e(this.doc.body).html()));t=""+t,this.source.is(":visible")?this.source.val(this.filter.source2source(t)):e.browser.msie?(this.doc.body.innerHTML="<br />"+this.filter.wysiwyg(t),this.doc.body.removeChild(this.doc.body.firstChild)):this.doc.body.innerHTML=this.filter.wysiwyg(t)},elRTE.prototype.beforeSave=function(){this.source.val(e.trim(this.val())||"")},elRTE.prototype.save=function(){this.beforeSave(),this.editor.parents("form").submit()},elRTE.prototype.log=function(e){window.console&&window.console.log&&window.console.log(e)},elRTE.prototype.i18Messages={},e.fn.elrte=function(e,t){var n=typeof e=="string"?e:"",r;return this.each(function(){this.elrte||(this.elrte=new elRTE(this,typeof e=="object"?e:{}));switch(n){case"open":case"show":this.elrte.open();break;case"close":case"hide":this.elrte.close();break;case"updateSource":this.elrte.updateSource();break;case"destroy":this.elrte.destroy()}}),n=="val"?this.length?this.length==1?t?this[0].elrte.val(t):this[0].elrte.val():(r={},this.each(function(){r[this.elrte.source.attr("name")]=this.elrte.val()}),r):"":this}}(jQuery),function(e){elRTE.prototype.dom=function(t){this.rte=t;var n=this;this.regExp={textNodes:/^(A|ABBR|ACRONYM|ADDRESS|B|BDO|BIG|BLOCKQUOTE|CAPTION|CENTER|CITE|CODE|DD|DEL|DFN|DIV|DT|EM|FIELDSET|FONT|H[1-6]|I|INS|KBD|LABEL|LEGEND|LI|MARQUEE|NOBR|NOEMBED|P|PRE|Q|SAMP|SMALL|SPAN|STRIKE|STRONG|SUB|SUP|TD|TH|TT|VAR)$/,textContainsNodes:/^(A|ABBR|ACRONYM|ADDRESS|B|BDO|BIG|BLOCKQUOTE|CAPTION|CENTER|CITE|CODE|DD|DEL|DFN|DIV|DL|DT|EM|FIELDSET|FONT|H[1-6]|I|INS|KBD|LABEL|LEGEND|LI|MARQUEE|NOBR|NOEMBED|OL|P|PRE|Q|SAMP|SMALL|SPAN|STRIKE|STRONG|SUB|SUP|TABLE|THEAD|TBODY|TFOOT|TD|TH|TR|TT|UL|VAR)$/,block:/^(APPLET|BLOCKQUOTE|BR|CAPTION|CENTER|COL|COLGROUP|DD|DIV|DL|DT|H[1-6]|EMBED|FIELDSET|LI|MARQUEE|NOBR|OBJECT|OL|P|PRE|TABLE|THEAD|TBODY|TFOOT|TD|TH|TR|UL)$/,selectionBlock:/^(APPLET|BLOCKQUOTE|BR|CAPTION|CENTER|COL|COLGROUP|DD|DIV|DL|DT|H[1-6]|EMBED|FIELDSET|LI|MARQUEE|NOBR|OBJECT|OL|P|PRE|TD|TH|TR|UL)$/,header:/^H[1-6]$/,formElement:/^(FORM|INPUT|HIDDEN|TEXTAREA|SELECT|BUTTON)$/},this.root=function(){return this.rte.body},this.create=function(e){return this.rte.doc.createElement(e)},this.createBookmark=function(){var t=this.rte.doc.createElement("span");return t.id="elrte-bm-"+Math.random().toString().substr(2),e(t).addClass("elrtebm elrte-protected"),t},this.indexOf=function(t){var n=0;t=e(t);while((t=t.prev())&&t.length)n++;return n},this.attr=function(t,n){var r="";return t.nodeType==1&&(r=e(t).attr(n),r&&n!="src"&&n!="href"&&n!="title"&&n!="alt"&&(r=r.toString().toLowerCase())),r||""},this.findCommonAncestor=function(t,n){if(!t||!n)return this.rte.log("dom.findCommonAncestor invalid arguments");if(t==n)return t;if(t.nodeName=="BODY"||n.nodeName=="BODY")return this.rte.doc.body;var r=e(t).parents(),i=e(n).parents(),s=i.length-1,o=i[s];for(var u=r.length-1;u>=0;u--,s--){if(r[u]!=i[s])break;o=r[u]}return o},this.isEmpty=function(t){return t.nodeType==1?this.regExp.textNodes.test(t.nodeName)?e.trim(e(t).text()).length==0:!1:t.nodeType==3?/^(TABLE|THEAD|TFOOT|TBODY|TR|UL|OL|DL)$/.test(t.parentNode.nodeName)||t.nodeValue==""||e.trim(t.nodeValue).length==0&&!(t.nextSibling&&t.previousSibling&&t.nextSibling.nodeType==1&&t.previousSibling.nodeType==1&&!this.regExp.block.test(t.nextSibling.nodeName)&&!this.regExp.block.test(t.previousSibling.nodeName)):!0},this.next=function(e){while(e.nextSibling&&(e=e.nextSibling))if(e.nodeType==1||e.nodeType==3&&!this.isEmpty(e))return e;return null},this.prev=function(e){while(e.previousSibling&&(e=e.previousSibling))if(e.nodeType==1||e.nodeType==3&&!this.isEmpty(e))return e;return null},this.isPrev=function(e,t){while(e=this.prev(e))if(e==t)return!0;return!1},this.nextAll=function(e){var t=[];while(e=this.next(e))t.push(e);return t},this.prevAll=function(e){var t=[];while(e=this.prev(e))t.push(e);return t},this.toLineEnd=function(e){var t=[];while((e=this.next(e))&&e.nodeName!="BR"&&e.nodeName!="HR"&&this.isInline(e))t.push(e);return t},this.toLineStart=function(e){var t=[];while((e=this.prev(e))&&e.nodeName!="BR"&&e.nodeName!="HR"&&this.isInline(e))t.unshift(e);return t},this.isFirstNotEmpty=function(t){while(t=this.prev(t))if(t.nodeType==1||t.nodeType==3&&e.trim(t.nodeValue)!="")return!1;return!0},this.isLastNotEmpty=function(e){while(e=this.next(e))if(!this.isEmpty(e))return!1;return!0},this.isOnlyNotEmpty=function(e){return this.isFirstNotEmpty(e)&&this.isLastNotEmpty(e)},this.findLastNotEmpty=function(e){this.rte.log("findLastNotEmpty Who is here 0_o");if(e.nodeType==1&&(l=e.lastChild)){if(!this.isEmpty(l))return l;while(l.previousSibling&&(l=l.previousSibling))if(!this.isEmpty(l))return l}return!1},this.isInline=function(t){if(t.nodeType==3)return!0;if(t.nodeType==1){t=e(t);var n=t.css("display"),r=t.css("float");return n=="inline"||n=="inline-block"||r=="left"||r=="right"}return!0},this.is=function(e,t){if(e&&e.nodeName){typeof t=="string"&&(t=this.regExp[t]||/.?/);if(t instanceof RegExp&&e.nodeName)return t.test(e.nodeName);if(typeof t=="function")return t(e)}return!1},this.filter=function(e,t){var n=[],r;if(!e.push)return this.is(e,t)?e:null;for(r=0;r<e.length;r++)this.is(e[r],t)&&n.push(e[r]);return n},this.parents=function(e,t){var n=[];while(e&&(e=e.parentNode)&&e.nodeName!="BODY"&&e.nodeName!="HTML")this.is(e,t)&&n.push(e);return n},this.parent=function(e,t){return this.parents(e,t)[0]||null},this.selfOrParent=function(e,t,n){return this.is(e,t)?e:this.parent(e,n||t)},this.selfOrParentLink=function(e){return e=this.selfOrParent(e,/^A$/),e&&e.href?e:null},this.selfOrParentAnchor=function(e){return e=this.selfOrParent(e,/^A$/),e&&!e.href&&e.name?e:null},this.childLinks=function(t){var n=[];return e("a[href]",t).each(function(){n.push(this)}),n},this.selectionHas=function(e){var t=this.rte.selection.cloneContents(),n;if(t&&t.childNodes&&t.childNodes.length)for(n=0;n<t.childNodes.length;n++)if(typeof e=="function"){if(e(t.childNodes[n]))return!0}else if(t instanceof RegExp&&e.test(t.childNodes[n].nodeName))return!0;return!1},this.wrap=function(t,n){return t=e.isArray(t)?t:[t],n=n.nodeName?n:this.create(n),t[0]&&t[0].nodeType&&t[0].parentNode&&(n=t[0].parentNode.insertBefore(n,t[0]),e(t).each(function(){this!=n&&n.appendChild(this)})),n},this.unwrap=function(e){if(e&&e.parentNode){while(e.firstChild)e.parentNode.insertBefore(e.firstChild,e);e.parentNode.removeChild(e)}},this.wrapContents=function(e,t){t=t.nodeName?t:this.create(t);for(var n=0;n<e.childNodes.length;n++)t.appendChild(e.childNodes[n]);return e.appendChild(t),t},this.cleanNode=function(t){if(t.nodeType!=1)return;/^(P|LI)$/.test(t.nodeName)&&(l=this.findLastNotEmpty(t))&&l.nodeName=="BR"&&e(l).remove(),$n=e(t),$n.children().each(function(){this.cleanNode(this)});if(t.nodeName!="BODY"&&!/^(TABLE|TR|TD)$/.test(t)&&this.isEmpty(t))return $n.remove();$n.attr("style")===""&&$n.removeAttr("style"),this.rte.browser.safari&&$n.hasClass("Apple-span")&&$n.removeClass("Apple-span"),t.nodeName=="SPAN"&&!$n.attr("style")&&!$n.attr("class")&&!$n.attr("id")&&$n.replaceWith($n.html())},this.cleanChildNodes=function(t){var n=this.cleanNode;e(t).children().each(function(){n(this)})},this.tableMatrix=function(t){var n=[];if(t&&t.nodeName=="TABLE"){var r=0;function i(e){for(var t=0;t<=r;t++)if(!n[e][t])return t}e(t).find("tr").each(function(t){e.isArray(n[t])||(n[t]=[]),e(this).children("td,th").each(function(){var s=parseInt(e(this).attr("colspan")||1),o=parseInt(e(this).attr("rowspan")||1),u=i(t);for(var l=0;l<o;l++)for(var c=0;c<s;c++){var p=t+l;e.isArray(n[p])||(n[p]=[]);var d=c==0&&l==0?this:l==0?c:"-";n[p][u+c]=d}r=Math.max(r,n[t].length)})})}return n},this.indexesOfCell=function(e,t){for(var n=0;n<t.length;n++)for(var r=0;r<t[n].length;r++)if(t[n][r]==e)return[n,r]},this.fixTable=function(t){if(t&&t.nodeName=="TABLE"){var n=e(t),r=this.tableMatrix(t),s=0;e.each(r,function(){s=Math.max(s,this.length)});if(s==0)return n.remove();for(var o=0;o<r.length;o++){var u=r[o].length;if(u==0)n.find("tr").eq(o).remove();else if(u<s){var f=s-u,l=n.find("tr").eq(o);for(i=0;i<f;i++)l.append("<td>&nbsp;</td>")}}}},this.tableColumn=function(e,t,n){e=this.selfOrParent(e,/^TD|TH$/);var r=this.selfOrParent(e,/^TABLE$/);ret=[],info={offset:[],delta:[]};if(e&&r){n&&this.fixTable(r);var i=this.tableMatrix(r),s=!1,o;for(var u=0;u<i.length;u++){for(var a=0;a<i[u].length;a++)if(i[u][a]==e){o=a,s=!0;break}if(s)break}if(o>=0)for(var u=0;u<i.length;u++){var f=i[u][o]||null;if(f)if(f.nodeName)ret.push(f),t&&(info.delta.push(0),info.offset.push(o));else{var l=parseInt(f);!isNaN(l)&&i[u][o-l]&&i[u][o-l].nodeName&&(ret.push(i[u][o-l]),t&&(info.delta.push(l
),info.offset.push(o)))}}}return t?{column:ret,info:info}:ret}}}(jQuery),function(e){elRTE.prototype.filter=function(t){var n=this,r=e("<span/>").addClass("elrtetesturl").appendTo(document.body)[0];this.url=(typeof r.currentStyle!="undefined"?r.currentStyle.backgroundImage:document.defaultView.getComputedStyle(r,null).backgroundImage).replace(/^url\((['"]?)([\s\S]+\/)[\s\S]+\1\)$/i,"$2"),e(r).remove(),this.rte=t,this.xhtml=/xhtml/i.test(t.options.doctype),this.boolAttrs=t.utils.makeObject("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected".split(",")),this.tagRegExp=/<(\/?)([\w:]+)((?:\s+[a-z\-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*\/?>/g,this.openTagRegExp=/<([\w:]+)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*\/?>/g,this.attrRegExp=/(\w+)(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^\s]+))?/g,this.scriptRegExp=/<script([^>]*)>([\s\S]*?)<\/script>/gi,this.styleRegExp=/(<style([^>]*)>[\s\S]*?<\/style>)/gi,this.linkRegExp=/(<link([^>]+)>)/gi,this.cdataRegExp=/<!\[CDATA\[([\s\S]+)\]\]>/g,this.objRegExp=/<object([^>]*)>([\s\S]*?)<\/object>/gi,this.embRegExp=/<(embed)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*>/gi,this.paramRegExp=/<(param)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*>/gi,this.iframeRegExp=/<iframe([^>]*)>([\s\S]*?)<\/iframe>/gi,this.yMapsRegExp=/<div\s+([^>]*id\s*=\s*('|")?YMapsID[^>]*)>/gi,this.gMapsRegExp=/<iframe\s+([^>]*src\s*=\s*"http:\/\/maps\.google\.\w+[^>]*)>([\s\S]*?)<\/iframe>/gi,this.videoHostRegExp=/^(http:\/\/[\w\.]*)?(youtube|vimeo|rutube).*/i,this.serviceClassRegExp=/<(\w+)([^>]*class\s*=\s*"[^>]*elrte-[^>]*)>\s*(<\/\1>)?/gi,this.pagebreakRegExp=/<(\w+)([^>]*style\s*=\s*"[^>]*page-break[^>]*)>\s*(<\/\1>)?/gi,this.pbRegExp=new RegExp("<!-- pagebreak -->","gi"),this.allowTags=t.options.allowTags.length?t.utils.makeObject(t.options.allowTags):null,this.denyTags=t.options.denyTags.length?t.utils.makeObject(t.options.denyTags):null,this.denyAttr=t.options.denyAttr?t.utils.makeObject(t.options.denyAttr):null,this.pasteDenyAttr=t.options.pasteDenyAttr?t.utils.makeObject(t.options.pasteDenyAttr):null,this.fontSize=["medium","xx-small","small","medium","large","x-large","xx-large"],this.fontFamily={"sans-serif":/^(arial|tahoma|verdana)$/i,serif:/^(times|times new roman)$/i,monospace:/^courier$/i},this.scripts={},this._chains={},e.each(this.chains,function(t){n._chains[t]=[],e.each(this,function(e,r){typeof n.rules[r]=="function"&&n._chains[t].push(n.rules[r])})}),this.proccess=function(t,r){return r=e.trim(r).replace(/^\s*(&nbsp;)+/gi,"").replace(/(&nbsp;|<br[^>]*>)+\s*$/gi,""),e.each(this._chains[t]||[],function(){r=this.call(n,r)}),r=r.replace(/\t/g,"  ").replace(/\r/g,"").replace(/\s*\n\s*\n+/g,"\n")+"  ",e.trim(r)?r:" "},this.wysiwyg=function(e){return this.proccess("wysiwyg",e)},this.source=function(e){return this.proccess("source",e)},this.source2source=function(e){return this.proccess("source2source",e)},this.wysiwyg2wysiwyg=function(e){return this.proccess("wysiwyg2wysiwyg",e)},this.parseAttrs=function(t){var n={},r=this.boolAttrs,i=t.match(this.attrRegExp),s,o,u;return i&&e.each(i,function(t,i){s=i.split("="),o=e.trim(s[0]).toLowerCase(),s.length>2?(s.shift(),u=s.join("=")):u=r[o]||s[1]||"",n[o]=e.trim(u).replace(/^('|")(.*)(\1)$/,"$2")}),n.style=this.rte.utils.parseStyle(n.style),n["class"]=this.rte.utils.parseClass(n["class"]||""),n},this.serializeAttrs=function(t,n){var r=[],i=this;return e.each(t,function(e,t){e=="style"?t=i.rte.utils.serializeStyle(t,n):e=="class"&&(t=i.rte.utils.serializeClass(t)),t&&r.push(e+'="'+t+'"')}),r.join(" ")},this.cleanAttrs=function(t,n){function s(e){return e+(/\d$/.test(e)?"px":"")}var r=this,i=this.replaceAttrs;return e.each(t["class"],function(e){/^(Apple-style-span|mso\w+)$/i.test(e)&&delete t["class"][e]}),e.each(t,function(u,f){i[u]&&i[u].call(r,t,n),u=="style"&&e.each(f,function(e,n){switch(e){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-table-layout-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":t.style[e.replace(/^mso-|-alt$/g,"")]=s(n),delete t.style[e];break;case"horiz-align":t.style["text-align"]=n,delete t.style[e];break;case"vert-align":t.style["vertical-align"]=n,delete t.style[e];break;case"font-color":case"mso-foreground":t.style.color=n,delete t.style[e];break;case"mso-background":case"mso-highlight":t.style.background=n,delete t.style[e];break;case"mso-default-height":t.style["min-height"]=s(n),delete t.style[e];break;case"mso-default-width":t.style["min-width"]=s(n),delete t.style[e];break;case"mso-padding-between-alt":t.style["border-collapse"]="separate",t.style["border-spacing"]=s(n),delete t.style[e];break;case"text-line-through":n.match(/(single|double)/i)&&(t.style["text-decoration"]="line-through"),delete t.style[e];break;case"mso-zero-height":n=="yes"&&(t.style.display="none"),delete t.style[e];break;case"font-weight":n==700&&(t.style["font-weight"]="bold");break;default:e.match(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?!align|decor|indent|trans)|top-bar|version|vnd|word-break)/)&&delete t.style[e]}})}),t}},elRTE.prototype.filter.prototype.replaceTags={b:{tag:"strong"},big:{tag:"span",style:{"font-size":"large"}},center:{tag:"div",style:{"text-align":"center"}},i:{tag:"em"},font:{tag:"span"},nobr:{tag:"span",style:{"white-space":"nowrap"}},menu:{tag:"ul"},plaintext:{tag:"pre"},s:{tag:"strike"},small:{tag:"span",style:{"font-size":"small"}},u:{tag:"span",style:{"text-decoration":"underline"}},xmp:{tag:"pre"}},elRTE.prototype.filter.prototype.replaceAttrs={align:function(e,t){switch(t){case"img":e.style[e.align.match(/(left|right)/)?"float":"vertical-align"]=e.align;break;case"table":e.align=="center"?e.style["margin-left"]=e.style["margin-right"]="auto":e.style["float"]=e.align;break;default:e.style["text-align"]=e.align}delete e.align},border:function(e){!e.style["border-width"]&&(e.style["border-width"]=(parseInt(e.border)||1)+"px"),!e.style["border-style"]&&(e.style["border-style"]="solid"),delete e.border},bordercolor:function(e){!e.style["border-color"]&&(e.style["border-color"]=e.bordercolor),delete e.bordercolor},background:function(e){!e.style["background-image"]&&(e.style["background-image"]="url("+e.background+")"),delete e.background},bgcolor:function(e){!e.style["background-color"]&&(e.style["background-color"]=e.bgcolor),delete e.bgcolor},clear:function(e){e.style.clear=e.clear=="all"?"both":e.clear,delete e.clear},color:function(e){!e.style.color&&(e.style.color=e.color),delete e.color},face:function(t){var n=t.face.toLowerCase();e.each(this.fontFamily,function(e,r){n.match(r)&&(t.style["font-family"]=n+","+e)}),delete t.face},hspace:function(e,t){if(t=="img"){var n=parseInt(e.hspace)||0;!e.style["margin-left"]&&(e.style["margin-left"]=n+"px"),!e.style["margin-right"]&&(e.style["margin-right"]=n+"px"),delete e.hspace}},size:function(e,t){t!="input"&&(e.style["font-size"]=this.fontSize[parseInt(e.size)||0]||"medium",delete e.size)},valign:function(e){e.style["vertical-align"]||(e.style["vertical-align"]=e.valign),delete e.valign},vspace:function(e,t){if(t=="img"){var n=parseInt(e.vspace)||0;!e.style["margin-top"]&&(e.style["margin-top"]=n+"px"),!e.style["margin-bottom"]&&(e.style["margin-bottom"]=n+"px"),delete e.hspace}}},elRTE.prototype.filter.prototype.rules={allowedTags:function(e){var t=this.allowTags;return t?e.replace(this.tagRegExp,function(e,n,r){return t[r.toLowerCase()]?e:""}):e},deniedTags:function(e){var t=this.denyTags;return t?e.replace(this.tagRegExp,function(e,n,r){return t[r.toLowerCase()]?"":e}):e},clean:function(t){var n=this,r=this.replaceTags,i=this.replaceAttrs,s=this.denyAttr,o;return t=t.replace(/<!DOCTYPE([\s\S]*)>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s&nbsp;]*)<\/span>/gi,"$1").replace(/(<p[^>]*>\s*<\/p>|<p[^>]*\/>)/gi,"<br>").replace(/(<\/p>)(?:\s*<br\s*\/?>\s*|\s*&nbsp;\s*)+\s*(<p[^>]*>)/gi,function(e,t,n){return t+"\n"+n}).replace(this.tagRegExp,function(t,i,o,u){return o=o.toLowerCase(),i?"</"+(r[o]?r[o].tag:o)+">":(u=n.cleanAttrs(n.parseAttrs(u||""),o),r[o]&&(r[o].style&&e.extend(u.style,r[o].style),o=r[o].tag),s&&e.each(u,function(e){s[e]&&delete u[e]}),u=n.serializeAttrs(u),"<"+o+(u?" ":"")+u+">")}),o=e("<div>"+t+"</div>"),o.find("span:not([id]):not([class])").each(function(){var t=e(this);t.attr("style")||(e.trim(t.html()).length?n.rte.dom.unwrap(this):t.remove())}).end().find("span span:only-child").each(function(){var t=e(this),r=t.parent().eq(0),i=t.attr("id"),s=r.attr("id"),o,u,f;n.rte.dom.isOnlyNotEmpty(this)&&(!i||!s)&&(f=e.trim(r.attr("class")+" "+t.attr("class")),f&&r.attr("class",f),u=n.rte.utils.serializeStyle(e.extend(n.rte.utils.parseStyle(e(this).attr("style")||""),n.rte.utils.parseStyle(e(r).attr("style")||""))),u&&r.attr("style",u),o=i||s,o&&r.attr("id",o),this.firstChild?e(this.firstChild).unwrap():t.remove())}).end().find("a[name]").each(function(){e(this).addClass("elrte-protected elrte-anchor")}),o.html()},cleanPaste:function(t){var n=this,r=this.pasteDenyAttr;return t=t.replace(this.scriptRegExp,"").replace(this.styleRegExp,"").replace(this.linkRegExp,"").replace(this.cdataRegExp,"").replace(/\<\!--[\s\S]*?--\>/g,""),this.rte.options.pasteOnlyText?t=t.replace(this.tagRegExp,function(e,t,n){return/br/i.test(n)||t&&/h[1-6]|p|ol|ul|li|div|blockquote|tr/i?"<br>":""}).replace(/(&nbsp;|<br[^>]*>)+\s*$/gi,""):r&&(t=t.replace(this.openTagRegExp,function(t,i,s){return s=n.parseAttrs(s),e.each(s,function(e){r[e]&&delete s[e]}),s=n.serializeAttrs(s,!0),"<"+i+(s?" ":"")+s+">"})),t},replace:function(t){function s(e,t){function l(){if(e.embed&&e.embed.src)return e.embed.src;if(e.params&&e.params.length){f=e.params.length;while(f--)if(e.params[f].name=="src"||e.params[f].name=="movie")return e.params[f].value}}var r=l(),i=r&&n.videoHostRegExp.test(r)?r.replace(n.videoHostRegExp,"$2"):t.replace(/^\w+\/(.+)/,"$1"),s=parseInt((e.obj?e.obj.width||e.obj.style.width:0)||(e.embed?e.embed.width||e.embed.style.width:0))||150,o=parseInt((e.obj?e.obj.height||e.obj.style.height:0)||(e.embed?e.embed.height||e.embed.style.height:0))||100,u="media"+Math.random().toString().substring(2),a="",f;return e.obj&&e.obj.style&&e.obj.style["float"]&&(a=' style="float:'+e.obj.style["float"]+'"'),n.scripts[u]=e,'<img src="'+n.url+'pixel.gif" class="elrte-media elrte-media-'+i+' elrte-protected" title="'+(r?n.rte.utils.encode(r):"")+'" rel="'+u+'" width="'+s+'" height="'+o+'"'+a+">"}var n=this,r=this.rte.options.replace||[],i;r.length&&e.each(r,function(e,r){typeof r=="function"&&(t=r.call(n,t))}),t=t.replace(this.styleRegExp,"<!-- ELRTE_COMMENT$1 -->").replace(this.linkRegExp,"<!-- ELRTE_COMMENT$1-->").replace(this.cdataRegExp,"<!--[CDATA[$1]]-->").replace(this.scriptRegExp,function(e,t,r){var i;return n.denyTags.script?"":(i="script"+Math.random().toString().substring(2),t=n.parseAttrs(t),!t.type&&(t.type="text/javascript"),n.scripts[i]="<script "+n.serializeAttrs(t)+">"+r+"</script>","<!-- ELRTE_SCRIPT:"+i+" -->")}).replace(this.yMapsRegExp,function(e,t){return t=n.parseAttrs(t),t["class"]["elrte-yandex-maps"]="elrte-yandex-maps",t["class"]["elrte-protected"]="elrte-protected","<div "+n.serializeAttrs(t)+">"}).replace(this.gMapsRegExp,function(e,t){var r="gmaps"+Math.random().toString().substring(2),i,s;return t=n.parseAttrs(t),i=parseInt(t.width||t.style.width||100),s=parseInt(t.height||t.style.height||100),n.scripts[r]=e,'<img src="'+n.url+'pixel.gif" class="elrte-google-maps elrte-protected" id="'+r+'" style="width:'+i+"px;height:"+s+'px">'}).replace(this.objRegExp,function(t,r,i){var o=i.match(n.embRegExp),u={obj:n.parseAttrs(r),embed:o&&o.length?n.parseAttrs(o[0].substring(7)):null,params:[]},f=n.rte.utils.mediaInfo(u.embed?u.embed.type||"":"",u.obj.classid||"");return f?((o=i.match(n.paramRegExp))&&e.each(o,function(e,t){u.params.push(n.parseAttrs(t.substring(6)))}),!u.obj.classid&&(u.obj.classid=f.classid[0]),!u.obj.codebase&&(u.obj.codebase=f.codebase),u.embed&&!u.embed.type&&(u.embed.type=f.type),u.obj.width=="1"&&delete u.obj.width,u.obj.height=="1"&&delete u.obj.height,u.embed&&(u.embed.width=="1"&&delete u.embed.width,u.embed.height=="1"&&delete u.embed.height),s(u,f.type)):t}).replace(this.embRegExp,function(e,t,r){var r=n.parseAttrs(r),i=n.rte.utils.mediaInfo(r.type||"");return r.width=="1"&&delete r.width,r.height=="1"&&delete r.height,i?s({embed:r},i.type):e}).replace(this.iframeRegExp,function(e,t){var t=n.parseAttrs(t),r=t.style.width||(parseInt(t.width)>1?parseInt(t.width)+"px":"100px"),i=t.style.height||(parseInt(t.height)>1?parseInt(t.height)+"px":"100px"),s="iframe"+Math.random().toString().substring(2);n.scripts[s]=e;var o='<img id="'+s+'" src="'+n.url+'pixel.gif" class="elrte-protected elrte-iframe" style="width:'+r+"; height:"+i+'">';return o}).replace(this.vimeoRegExp,function(e,t,r){return r=n.parseAttrs(r),delete r.frameborder,r.width=="1"&&delete r.width,r.height=="1"&&delete r.height,r.type="application/x-shockwave-flash",s({embed:r},"application/x-shockwave-flash")}).replace(/<\/(embed|param)>/gi,"").replace(this.pbRegExp,function(){return'<img src="'+n.url+'pixel.gif" class="elrte-protected elrte-pagebreak">'}),i=e("<div>"+t+"</div>");if(!this.rte.options.allowTextNodes){var o=this.rte.dom,u=[],f=[];if(e.browser.msie)for(var l=0;l<i[0].childNodes.length;l++)u.push(i[0].childNodes[l]);else u=Array.prototype.slice.call(i[0].childNodes);function c(){f.length&&o.filter(f,"notEmpty").length&&o.wrap(f,document.createElement("p")),f=[]}e.each(u,function(e,t){o.is(t,"block")?c():(f.length&&t.previousSibling!=f[f.length-1]&&c(),f.push(t))}),c()}return i.html()},restore:function(t){var n=this,r=this.rte.options.restore||[];return r.length&&e.each(r,function(e,r){typeof r=="function"&&(t=r.call(n,t))}),t=t.replace(/\<\!--\[CDATA\[([\s\S]*?)\]\]--\>/gi,"<![CDATA[$1]]>").replace(/\<\!--\s*ELRTE_SCRIPT\:\s*(script\d+)\s*--\>/gi,function(e,t){return n.scripts[t]&&(e=n.scripts[t],delete n.scripts[t]),e||""}).replace(/\<\!-- ELRTE_COMMENT([\s\S]*?) --\>/gi,"$1").replace(this.serviceClassRegExp,function(t,r,i,s){var i=n.parseAttrs(i),o,u="";if(i["class"]["elrte-google-maps"]){var t="";return n.scripts[i.id]&&(t=n.scripts[i.id],delete n.scripts[i.id]),t}return i["class"]["elrte-iframe"]?n.scripts[i.id]||"":i["class"].elrtebm?"":i["class"]["elrte-media"]?(o=n.scripts[i.rel]||{},o.params&&e.each(o.params,function(e,t){u+="<param "+n.serializeAttrs(t)+">\n"}),o.embed&&(u+="<embed "+n.serializeAttrs(o.embed)+">"),o.obj&&(u="<object "+n.serializeAttrs(o.obj)+">\n"+u+"\n</object>\n"),u||t):i["class"]["elrte-pagebreak"]?"<!-- pagebreak -->":(e.each(i["class"],function(e){/^elrte-\w+/i.test(e)&&delete i["class"][e]}),"<"+r+" "+n.serializeAttrs(i)+">"+(s||""))}),t},compactStyles:function(e){var t=this;return e.replace(this.tagRegExp,function(e,n,r,i){return i=!n&&i?t.serializeAttrs(t.parseAttrs(i),!0):"","<"+n+r.toLowerCase()+(i?" ":"")+i+">"})},xhtmlTags:function(e){return this.xhtml?e.replace(/<(img|hr|br|embed|param|link|area)([^>]*\/*)>/gi,"<$1$2 />"):e}},elRTE.prototype.filter.prototype.chains={wysiwyg:["replace","clean","allowedTags","deniedTags","compactStyles"],source:["clean","allowedTags","restore","compactStyles","xhtmlTags"],paste:["clean","allowedTags","cleanPaste","replace","deniedTags","compactStyles"],wysiwyg2wysiwyg:["clean","allowedTags","restore","replace","deniedTags","compactStyles"],source2source:["clean","allowedTags","replace","deniedTags","restore","compactStyles","xhtmlTags"]}}(jQuery),function(e){elRTE.prototype.history=function(t){this.rte=t,this._prev=[],this._next=[],this.add=function(){this.rte.options.historyLength>0&&this._prev.length>=this.rte.options.historyLength&&this._prev.slice(this.rte.options.historyLength);var t=this.rte.selection.getBookmark();this._prev.push([e(this.rte.doc.body).html(),t]),this.rte.selection.moveToBookmark(t),this._next=[]},this.back=function(){if(this._prev.length){var t=this.rte.selection.getBookmark(),n=this._prev.pop();this._next.push([e(this.rte.doc.body).html(),t]),e(this.rte.doc.body).html(n[0]),this.rte.selection.moveToBookmark(n[1])}},this.fwd=function(){if(this._next.length){var t=this.rte.selection.getBookmark(),n=this._next.pop();this._prev.push([e(this.rte.doc.body).html(),t]),e(this.rte.doc.body).html(n[0]),this.rte.selection.moveToBookmark(n[1])}},this.canBack=function(){return this._prev.length},this.canFwd=function(){return this._next.length}}}(jQuery),function(e){elRTE.prototype.options={doctype:'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">',cssClass:"el-rte",cssfiles:[],height:null,resizable:!0,lang:"en",toolbar:"normal",absoluteURLs:!0,allowSource:!0,stripWhiteSpace:!0,styleWithCSS:!1,fmAllow:!0,fmOpen:null,allowTags:[],denyTags:["applet","base","basefont","bgsound","blink","body","col","colgroup","isindex","frameset","html","head","meta","marquee","noframes","noembed","o:p","title","xml"],denyAttr:[],pasteDenyAttr:["id","name","class","style","language","onclick","ondblclick","onhover","onkeup","onkeydown","onkeypress"],allowTextNodes:!0,allowBrowsersSpecStyles:!1,allowPaste:!0,pasteOnlyText:!1,replace:[],restore:[],pagebreak:'<div style="page-break-after: always;"></div>',buttons:{save:"Save",copy:"Copy",cut:"Cut",css:"Css style and class",paste:"Paste",pastetext:"Paste only text",pasteformattext:"Paste formatted text",removeformat:"Clean format",undo:"Undo last action",redo:"Redo previous action",bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",superscript:"Superscript",subscript:"Subscript",justifyleft:"Align left",justifyright:"Ailgn right",justifycenter:"Align center",justifyfull:"Align full",indent:"Indent",outdent:"Outdent",rtl:"Right to left",ltr:"Left to right",forecolor:"Font color",hilitecolor:"Background color",formatblock:"Format",fontsize:"Font size",fontname:"Font",insertorderedlist:"Ordered list",insertunorderedlist:"Unordered list",horizontalrule:"Horizontal rule",blockquote:"Blockquote",div:"Block element (DIV)",link:"Link",unlink:"Delete link",anchor:"Bookmark",image:"Image",pagebreak:"Page break",smiley:"Smiley",flash:"Flash",table:"Table",tablerm:"Delete table",tableprops:"Table properties",tbcellprops:"Table cell properties",tbrowbefore:"Insert row before",tbrowafter:"Insert row after",tbrowrm:"Delete row",tbcolbefore:"Insert column before",tbcolafter:"Insert column after",tbcolrm:"Delete column",tbcellsmerge:"Merge table cells",tbcellsplit:"Split table cell",docstructure:"Toggle display document structure",elfinder:"Open file manager",fullscreen:"Toggle full screen mode",nbsp:"Non breakable space",stopfloat:"Stop element floating",about:"About this software"},panels:{eol:[],save:["save"],copypaste:["copy","cut","paste","pastetext","pasteformattext","removeformat","docstructure"],undoredo:["undo","redo"],style:["bold","italic","underline","strikethrough","subscript","superscript"],colors:["forecolor","hilitecolor"],alignment:["justifyleft","justifycenter","justifyright","justifyfull"],indent:["outdent","indent"],format:["formatblock","fontsize","fontname"],lists:["insertorderedlist","insertunorderedlist"],elements:["horizontalrule","blockquote","div","stopfloat","css","nbsp","smiley","pagebreak"],direction:["ltr","rtl"],links:["link","unlink","anchor"],images:["image"],media:["image","flash"],tables:["table","tableprops","tablerm","tbrowbefore","tbrowafter","tbrowrm","tbcolbefore","tbcolafter","tbcolrm","tbcellprops","tbcellsmerge","tbcellsplit"],elfinder:["elfinder"],fullscreen:["fullscreen","about"]},toolbars:{tiny:["style"],compact:["save","undoredo","style","alignment","lists","links","fullscreen"],normal:["save","copypaste","undoredo","style","alignment","colors","indent","lists","links","elements","images","fullscreen"],complete:["save","copypaste","undoredo","style","alignment","colors","format","indent","lists","links","elements","media","fullscreen"],maxi:["save","copypaste","undoredo","elfinder","style","alignment","direction","colors","format","indent","lists","links","elements","media","tables","fullscreen"],eldorado:["save","copypaste","elfinder","undoredo","style","alignment","colors","format","indent","lists","links","elements","media","tables","fullscreen"]},panelNames:{save:"Save",copypaste:"Copy/Pase",undoredo:"Undo/Redo",style:"Text styles",colors:"Colors",alignment:"Alignment",indent:"Indent/Outdent",format:"Text format",lists:"Lists",elements:"Misc elements",direction:"Script direction",links:"Links",images:"Images",media:"Media",tables:"Tables",elfinder:"File manager (elFinder)"}}}(jQuery),function(e){elRTE.prototype.selection=function(t){function u(){return n.rte.window.getSelection?n.rte.window.getSelection():n.rte.window.document.selection}function f(e,t,r){while(e.nodeName!="BODY"&&e.parentNode&&e.parentNode.nodeName!="BODY"&&(t?e!==t&&e.parentNode!=t:1)&&(r=="left"&&n.rte.dom.isFirstNotEmpty(e)||r=="right"&&n.rte.dom.isLastNotEmpty(e)||n.rte.dom.isFirstNotEmpty(e)&&n.rte.dom.isLastNotEmpty(e)))e=e.parentNode;return e}this.rte=t;var n=this;this.w3cRange=null;var r,i,s,o;e(this.rte.doc).keyup(function(e){(e.ctrlKey||e.metaKey||e.keyCode>=8&&e.keyCode<=13||e.keyCode>=32&&e.keyCode<=40||e.keyCode==46||e.keyCode>=96&&e.keyCode<=111)&&n.cleanCache()}).mousedown(function(e){e.target.nodeName=="HTML"?r=n.rte.doc.body:r=e.target,i=s=null}).mouseup(function(e){e.target.nodeName=="HTML"?i=n.rte.doc.body:i=e.target,i=e.target,s=null}).click(),this.collapsed=function(){return this.getRangeAt().isCollapsed()},this.collapse=function(t){var n=u(),r=this.getRangeAt();return r.collapse(t?!0:!1),e.browser.msie||(n.removeAllRanges(),n.addRange(r)),this},this.getRangeAt=function(e){if(this.rte.browser.msie)return this.w3cRange||(this.w3cRange=new this.rte.w3cRange(this.rte)),e&&this.w3cRange.update(),this.w3cRange;var t=u(),n=t.rangeCount>0?t.getRangeAt(0):this.rte.doc.createRange();return n.getStart=function(){return this.startContainer.nodeType==1?this.startContainer.childNodes[Math.min(this.startOffset,this.startContainer.childNodes.length-1)]:this.startContainer},n.getEnd=function(){return this.endContainer.nodeType==1?this.endContainer.childNodes[Math.min(this.startOffset==this.endOffset?this.endOffset:this.endOffset-1,this.endContainer.childNodes.length-1)]:this.endContainer},n.isCollapsed=function(){return this.collapsed},n},this.saveIERange=function(){e.browser.msie&&(o=this.getRangeAt().getBookmark())},this.restoreIERange=function(){e.browser.msie&&o&&this.getRangeAt().moveToBookmark(o)},this.cloneContents=function(){var t=this.rte.dom.create("div"),n,r,i;if(e.browser.msie){try{n=this.rte.window.document.selection.createRange()}catch(s){n=this.rte.doc.body.createTextRange()}e(t).html(n.htmlText)}else{r=this.getRangeAt().cloneContents();for(i=0;i<r.childNodes.length;i++)t.appendChild(r.childNodes[i].cloneNode(!0))}return t},this.select=function(e,t){t=t||e;if(this.rte.browser.msie){var n=this.rte.doc.body.createTextRange(),r=n.duplicate(),i=n.duplicate();r.moveToElementText(e),i.moveToElementText(t),n.setEndPoint("StartToStart",r),n.setEndPoint("EndToEnd",i),n.select()}else{var s=u(),n=this.getRangeAt();n.setStartBefore(e),n.setEndAfter(t),s.removeAllRanges(),s.addRange(n)}return this.cleanCache()},this.selectContents=function(e){var t=this.getRangeAt();if(e&&e.nodeType==1)if(this.rte.browser.msie)t.range(),t.r.moveToElementText(e.parentNode),t.r.select();else{try{t.selectNodeContents(e)}catch(n){return this.rte.log("unable select node contents "+e)}var r=u();r.removeAllRanges(),r.addRange(t)}return this},this.deleteContents=function(){return e.browser.msie||this.getRangeAt().deleteContents(),this},this.insertNode=function(t,n){n&&!this.collapsed()&&this.collapse();if(this.rte.browser.msie){var r=t.nodeType==3?t.nodeValue:e(this.rte.dom.create("span")).append(e(t)).html(),i=this.getRangeAt();i.insertNode(r)}else{var i=this.getRangeAt();i.insertNode(t),i.setStartAfter(t),i.setEndAfter(t);var s=u();s.removeAllRanges(),s.addRange(i)}return this.cleanCache()},this.insertHtml=function(t,n){n&&!this.collapsed()&&this.collapse();if(this.rte.browser.msie)this.getRangeAt().range().pasteHTML(t);else{var r=e(this.rte.dom.create("span")).html(t||"").get(0);this.insertNode(r),e(r).replaceWith(e(r).html())}return this.cleanCache()},this.insertText=function(e,t){var n=this.rte.doc.createTextNode(e);return this.insertHtml(n.nodeValue)},this.getBookmark=function(){this.rte.window.focus();var t,n,r,i,s,o=this.rte.dom.createBookmark(),f=this.rte.dom.createBookmark();if(e.browser.msie){try{t=this.rte.window.document.selection.createRange()}catch(f){t=this.rte.doc.body.createTextRange()}if(t.item){var l=t.item(0);t=this.rte.doc.body.createTextRange(),t.moveToElementText(l)}n=t.duplicate(),r=t.duplicate(),i=this.rte.dom.create("span"),s=this.rte.dom.create("span"),i.appendChild(o),s.appendChild(f),n.collapse(!0),n.pasteHTML(i.innerHTML),r.collapse(!1),r.pasteHTML(s.innerHTML)}else{var c=u(),t=c.rangeCount>0?c.getRangeAt(0):this.rte.doc.createRange();n=t.cloneRange(),r=t.cloneRange(),r.collapse(!1),r.insertNode(f),n.collapse(!0),n.insertNode(o),this.select(o,f)}return[o.id,f.id]},this.moveToBookmark=function(t){this.rte.window.focus();if(t&&t.length==2){var n=this.rte.doc.getElementById(t[0]),r=this.rte.doc.getElementById(t[1]),i,s;n&&r&&(this.select(n,r),this.rte.dom.next(n)==r&&this.collapse(!0),e.browser.msie||(i=u(),s=i.rangeCount>0?i.getRangeAt(0):this.rte.doc.createRange(),i.removeAllRanges(),i.addRange(s)),n.parentNode.removeChild(n),r.parentNode.removeChild(r))}return this},this.removeBookmark=function(e){this.rte.window.focus();if(e.length==2){var t=this.rte.doc.getElementById(e[0]),n=this.rte.doc.getElementById(e[1]);t&&n&&(t.parentNode.removeChild(t),n.parentNode.removeChild(n))}},this.cleanCache=function(){return r=i=s=null,this},this.getStart=function(){if(!r){var e=this.getRangeAt();r=e.getStart()}return r},this.getEnd=function(){if(!i){var e=this.getRangeAt();i=e.getEnd()}return i},this.getNode=function(){return s||(s=this.rte.dom.findCommonAncestor(this.getStart(),this.getEnd())),s},this.selected=function(t){function h(){function t(){for(var t=0;t<f.length;t++)if(f[t].nodeType==1&&(n.rte.dom.selfOrParent(f[t],/^P$/)||e(f[t]).find("p").length>0))return!1;return!0}if(f.length>0){var i=r.tag=="p"&&!t()?"div":r.tag,s=n.rte.dom.wrap(f,i);u[l]=s,l=null,f=[]}}function p(t){if(t.nodeType==1)if(/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(t.nodeName))e(t).find("td,th").each(function(){var t=r.tag=="p"&&e(this).find("p").length>0?"div":r.tag,i=n.rte.dom.wrapContents(this,t);return u.push(i)});else if(/^(CAPTION|TD|TH|LI|DT|DD)$/.test(t.nodeName)){var i=r.tag=="p"&&e(t).find("p").length>0?"div":r.tag,t=n.rte.dom.wrapContents(t,i);return u.push(t)}var s=f.length>0?f[f.length-1]:null;s&&s!=n.rte.dom.prev(t)&&h(),f.push(t),l===null&&(l=u.length,u.push("dummy"))}var r={collapsed:!1,blocks:!1,filter:!1,wrap:"text",tag:"span"};r=e.extend({},r,t);if(r.blocks){var i=this.getNode(),s=null;if(s=this.rte.dom.selfOrParent(i,"selectionBlock"))return[s]}var o=this.selectedRaw(r.collapsed,r.blocks),u=[],f=[],l=null;if(o.nodes.length>0){for(var d=0;d<o.nodes.length;d++){var i=o.nodes[d];i.nodeType==3&&(d==0||d==o.nodes.length-1)&&e.trim(i.nodeValue).length>0&&(d==0&&o.so>0&&(i=i.splitText(o.so)),d==o.nodes.length-1&&o.eo>0&&i.splitText(d==0&&o.so>0?o.eo-o.so:o.eo));switch(r.wrap){case"text":i.nodeType==1&&i.nodeName=="BR"||i.nodeType==3&&e.trim(i.nodeValue).length>0?p(i):i.nodeType==1&&u.push(i);break;case"inline":this.rte.dom.isInline(i)?p(i):i.nodeType==1&&u.push(i);break;case"all":(i.nodeType==1||!this.rte.dom.isEmpty(i))&&p(i);break;default:(i.nodeType==1||!this.rte.dom.isEmpty(i))&&u.push(i)}}h()}return u.length&&(this.rte.window.focus(),this.select(u[0],u[u.length-1])),r.filter?this.rte.dom.filter(u,r.filter):u},this.dump=function(e,t,n,r,i){var s=this.getRangeAt();this.rte.log("commonAncestorContainer"),this.rte.log(e||s.commonAncestorContainer),this.rte.log("startContainer"),this.rte.log(t||s.startContainer),this.rte.log("startOffset: "+(r>=0?r:s.startOffset)),this.rte.log("endContainer"),this.rte.log(n||s.endContainer),this.rte.log("endOffset: "+(i>=0?i:s.endOffset))},this.selectedRaw=function(t,r){function d(t,n,r){return t.nodeType==3?(r=r>=0?r:t.nodeValue.length,n==0&&r==t.nodeValue.length||e.trim(t.nodeValue).length==e.trim(t.nodeValue.substring(n,r)).length):!0}function v(t,r,i){return t.nodeType==1?n.rte.dom.isEmpty(t):t.nodeType==3?e.trim(t.nodeValue.substring(r||0,i>=0?i:t.nodeValue.length)).length==0:!0}var i={so:null,eo:null,nodes:[]},s=this.getRangeAt(!0),o=s.commonAncestorContainer,u,l,h=!1,p=!1;s.startContainer.nodeType==1?s.startOffset<s.startContainer.childNodes.length?(u=s.startContainer.childNodes[s.startOffset],i.so=u.nodeType==1?null:0):(u=s.startContainer.childNodes[s.startOffset-1],i.so=u.nodeType==1?null:u.nodeValue.length):(u=s.startContainer,i.so=s.startOffset);if(s.collapsed){if(t)if(r){u=f(u);if(!this.rte.dom.isEmpty(u)||(u=this.rte.dom.next(u)))i.nodes=[u];this.rte.dom.isInline(u)&&(i.nodes=this.rte.dom.toLineStart(u).concat(i.nodes,this.rte.dom.toLineEnd(u))),i.nodes.length>0&&(i.so=i.nodes[0].nodeType==1?null:0,i.eo=i.nodes[i.nodes.length-1].nodeType==1?null:i.nodes[i.nodes.length-1].nodeValue.length)}else this.rte.dom.isEmpty(u)||(i.nodes=[u]);return i}s.endContainer.nodeType==1?(l=s.endContainer.childNodes[s.endOffset-1],i.eo=l.nodeType==1?null:l.nodeValue.length):(l=s.endContainer,i.eo=s.endOffset);if(u.nodeType==1||r||d(u,i.so,u.nodeValue.length))u=f(u,o,"left"),h=!0,i.so=u.nodeType==1?null:0;if(l.nodeType==1||r||d(l,0,i.eo))l=f(l,o,"right"),p=!0,i.eo=l.nodeType==1?null:l.nodeValue.length;r&&(u.nodeType!=1&&u.parentNode!=o&&u.parentNode.nodeName!="BODY"&&(u=u.parentNode,i.so=null),l.nodeType!=1&&l.parentNode!=o&&l.parentNode.nodeName!="BODY"&&(l=l.parentNode,i.eo=null)),u.parentNode==l.parentNode&&u.parentNode.nodeName!="BODY"&&h&&this.rte.dom.isFirstNotEmpty(u)&&p&&this.rte.dom.isLastNotEmpty(l)&&(u=l=u.parentNode,i.so=u.nodeType==1?null:0,i.eo=l.nodeType==1?null:l.nodeValue.length);if(u==l)return this.rte.dom.isEmpty(u)||i.nodes.push(u),i;var m=u;while(m.nodeName!="BODY"&&m.parentNode!==o&&m.parentNode.nodeName!="BODY")m=m.parentNode;var g=l;while(g.nodeName!="BODY"&&g.parentNode!==o&&g.parentNode.nodeName!="BODY")g=g.parentNode;v(u,i.so,u.nodeType==3?u.nodeValue.length:null)||i.nodes.push(u);var y=u;while(y!==m){var b=y;while(b=this.rte.dom.next(b))i.nodes.push(b);y=y.parentNode}y=m;while((y=this.rte.dom.next(y))&&y!=g)i.nodes.push(y);var w=[];y=l;while(y!==g){var b=y;while(b=this.rte.dom.prev(b))w.push(b);y=y.parentNode}return w.length&&(i.nodes=i.nodes.concat(w.reverse())),v(l,0,l.nodeType==3?i.eo:null)||i.nodes.push(l),r&&(this.rte.dom.isInline(u)&&(i.nodes=this.rte.dom.toLineStart(u).concat(i.nodes),i.so=i.nodes[0].nodeType==1?null:0),this.rte.dom.isInline(l)&&(i.nodes=i.nodes.concat(this.rte.dom.toLineEnd(l)),i.eo=i.nodes[i.nodes.length-1].nodeType==1?null:i.nodes[i.nodes.length-1].nodeValue.length)),i}}}(jQuery),function(e){elRTE.prototype.ui=function(t){this.rte=t,this._buttons=[];var n=this,r=this.rte.options.toolbars[t.options.toolbar&&t.options.toolbars[t.options.toolbar]?t.options.toolbar:"normal"],i=r.length,s,o,u,f,l,c,h;for(h in this.buttons)this.buttons.hasOwnProperty(h)&&h!="button"&&(this.buttons[h].prototype=this.buttons.button.prototype);while(i--){first=i==0?!0:!1,r[i-1]=="eol"&&(first=!0),o=r[i];if(o=="eol"){e(this.rte.doc.createElement("br")).prependTo(this.rte.toolbar);continue}s=e('<ul class="panel-'+o+(first?" first":"")+'" />').prependTo(this.rte.toolbar),s.bind("mousedown",function(e){e.preventDefault()}),u=this.rte.options.panels[o].length;while(u--)f=this.rte.options.panels[o][u],l=this.buttons[f]||this.buttons.button,this._buttons.push(c=new l(this.rte,f)),s.prepend(c.domElem)}this.update(),this.disable=function(){e.each(n._buttons,function(){!this.active&&this.domElem.addClass("disabled")})}},elRTE.prototype.ui.prototype.update=function(t){function l(t){var n=t.nodeName.toLowerCase();return t=e(t),n=="img"&&(t.hasClass("elrte-media")?n="media":t.hasClass("elrte-google-maps")?n="google map":t.hasClass("elrte-yandex-maps")?n="yandex map":t.hasClass("elrte-pagebreak")&&(n="pagebreak")),n}t&&this.rte.selection.cleanCache();var n=this.rte.selection.getNode(),r=this.rte.dom.parents(n,"*"),i=this.rte.rtl,s=i?" &laquo; ":" &raquo; ",o="",u,f;n&&n.nodeType==1&&
n.nodeName!="BODY"&&r.unshift(n),i||(r=r.reverse());for(f=0;f<r.length;f++)o+=(f>0?s:"")+l(r[f]);this.rte.statusbar.html(o),e.each(this._buttons,function(){this.update()}),this.rte.window.focus()},elRTE.prototype.ui.prototype.buttons={button:function(t,n){var r=this;this.rte=t,this.active=!1,this.name=n,this.val=null,this.domElem=e('<li style="-moz-user-select:-moz-none" class="'+n+' rounded-3" name="'+n+'" title="'+this.rte.i18n(this.rte.options.buttons[n]||n)+'" unselectable="on" />').hover(function(){e(this).addClass("hover")},function(){e(this).removeClass("hover")}).click(function(t){t.stopPropagation(),t.preventDefault(),e(this).hasClass("disabled")||r.command(),r.rte.window.focus()})}},elRTE.prototype.ui.prototype.buttons.button.prototype.command=function(){this.rte.history.add();try{this.rte.doc.execCommand(this.name,!1,this.val)}catch(e){return this.rte.log("commands failed: "+this.name)}this.rte.ui.update(!0)},elRTE.prototype.ui.prototype.buttons.button.prototype.update=function(){try{if(!this.rte.doc.queryCommandEnabled(this.name))return this.domElem.addClass("disabled");this.domElem.removeClass("disabled")}catch(e){return}try{this.rte.doc.queryCommandState(this.name)?this.domElem.addClass("active"):this.domElem.removeClass("active")}catch(e){}}}(jQuery),function(e){elRTE.prototype.utils=function(t){this.rte=t,this.url=null,this.reg=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,this.baseURL="",this.path="",this.entities={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"},this.entitiesRegExp=/[<>&\"]/g,this.media=[{type:"application/x-shockwave-flash",classid:["clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"],codebase:"http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"},{type:"application/x-director",classid:["clsid:166b1bca-3f9c-11cf-8075-444553540000"],codebase:"http://download.macromedia.com/pub/shockwave/cabs/director/sw.cab#version=8,5,1,0"},{type:"application/x-mplayer2",classid:["clsid:6bf52a52-394a-11d3-b153-00c04f79faa6","clsid:22d6f312-b0f6-11d0-94ab-0080c74c7e95","clsid:05589fa1-c356-11ce-bf01-00aa0055595a"],codebase:"http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=5,1,52,701"},{type:"video/quicktime",classid:["clsid:02bf25d5-8c17-4b23-bc80-d3488abddc6b"],codebase:"http://www.apple.com/qtactivex/qtplugin.cab#version=6,0,2,0"},{type:"audio/x-pn-realaudio-plugin",classid:["clsid:cfcdaa03-8be4-11cf-b84b-0020afbbccfa"],codebase:"http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"}],this.rgbRegExp=/\s*rgb\s*?\(\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?\)\s*/i,this.colorsRegExp=/aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|rgb\s*\([^\)]+\)/i,this.colors={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#fffffff",yellow:"#ffff00"};var n=this;this.rgb2hex=function(e){return this.color2Hex(""+e)},this.toPixels=function(t){var n=t.match(/([0-9]+\.?[0-9]*)\s*(px|pt|em|%)/);n&&(t=n[1],unit=n[2]),t[0]=="."&&(t="0"+t),t=parseFloat(t);if(isNaN(t))return"";var r=parseInt(e(document.body).css("font-size"))||16;switch(unit){case"em":return parseInt(t*r);case"pt":return parseInt(t*r/12);case"%":return parseInt(t*r/100)}return t},this.absoluteURL=function(t){!this.url&&this._url(),t=e.trim(t);if(!t)return"";if(t[0]=="#")return t;var n=this.parseURL(t);return!n.host&&!n.path&&!n.anchor?"":this.rte.options.absoluteURLs?n.protocol?t:!n.host||n.host.indexOf(".")==-1&&n.host!="localhost"?(t[0]=="/"?t=this.baseURL+t:(t.indexOf("./")==0&&(t=t.substring(2)),t=this.baseURL+this.path+t),t):this.url.protocol+"://"+t:t},this.parseURL=function(t){var n=t.match(this.reg),r={};return e.each(["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],function(e){r[this]=n[e]}),r.host.match(/[a-z0-9]/i)||(r.host=""),r},this.trimEventCallback=function(t){return t=t?t.toString():"",e.trim(t.replace(/\r*\n/mg,"").replace(/^function\s*on[a-z]+\s*\(\s*event\s*\)\s*\{(.+)\}$/igm,"$1"))},this._url=function(){this.url=this.parseURL(window.location.href),this.baseURL=this.url.protocol+"://"+(this.url.userInfo?parts.userInfo+"@":"")+this.url.host+(this.url.port?":"+this.url.port:""),this.path=this.url.file?this.url.path.substring(0,this.url.path.length-this.url.file.length):this.url.path},this.makeObject=function(t){var n={};return e.each(t,function(e,t){n[t]=t}),n},this.encode=function(e){var t=this.entities;return(""+e).replace(this.entitiesRegExp,function(e){return t[e]})},this.decode=function(t){return e("<div/>").html(t||"").text()},this.parseStyle=function(t){var n={},r=this.rte.options.allowBrowsersSpecStyles,i,s,o,u;return typeof t=="string"&&t.length&&e.each(t.replace(/&quot;/gi,"'").split(";"),function(t,i){if((u=i.indexOf(":"))!==-1){s=e.trim(i.substr(0,u)),o=e.trim(i.substr(u+1));if(s=="color"||s=="background-color")o=o.toLowerCase();s&&o&&(r||s.substring(0,1)!="-")&&(n[s]=o)}}),n},this.compactStyle=function(t){var n=this;t.border=="medium none"&&delete t.border,e.each(t,function(e,r){/color$/i.test(e)?t[e]=n.color2Hex(r):/^(border|background)$/i.test(e)&&(t[e]=r.replace(n.colorsRegExp,function(e){return n.color2Hex(e)}))}),t["border-width"]&&(t.border=t["border-width"]+" "+(t["border-style"]||"solid")+" "+(t["border-color"]||"#000"),delete t["border-width"],delete t["border-style"],delete t["border-color"]),t["background-image"]&&(t.background=t["background-color"]+" "||""+t["background-image"]+" "+t["background-position"]||"0 0 "+t["background-repeat"]||"repeat",delete t["background-image"],delete ["background-image"],delete ["background-position"],delete ["background-repeat"]),t["margin-top"]&&t["margin-right"]&&t["margin-bottom"]&&t["margin-left"]&&(t.margin=t["margin-top"]+" "+t["margin-right"]+" "+t["margin-bottom"]+" "+t["margin-left"],delete t["margin-top"],delete t["margin-right"],delete t["margin-bottom"],delete t["margin-left"]),t["padding-top"]&&t["padding-right"]&&t["padding-bottom"]&&t["padding-left"]&&(t.padding=t["padding-top"]+" "+t["padding-right"]+" "+t["padding-bottom"]+" "+t["padding-left"],delete t["padding-top"],delete t["padding-right"],delete t["padding-bottom"],delete t["padding-left"]);if(t["list-style-type"]||t["list-style-position"]||t["list-style-image"])t["list-style"]=e.trim(t["list-style-type"]||" "+t["list-style-position"]||""+t["list-style-image"]||""),delete t["list-style-type"],delete t["list-style-position"],delete t["list-style-image"];return t},this.serializeStyle=function(t,n){var r=[];return e.each(n?this.compactStyle(t):t,function(e,t){t&&r.push(e+":"+t)}),r.join(";")},this.parseClass=function(t){return t=e.trim(t),t.length?this.makeObject(t.split(/\s+/)):{}},this.serializeClass=function(t){var n=[],r=this.rte;return e.each(t,function(e){n.push(e)}),n.join(" ")},this.mediaInfo=function(t,n){var r=this.media.length;while(r--)if(t===this.media[r].type||n&&e.inArray(n,this.media[r].classid)!=-1)return this.media[r]},this.color2Hex=function(e){function n(e){return e=parseInt(e).toString(16),e.length>1?e:"0"+e}var t;return e=e||"",e.indexOf("#")===0?e:this.colors[e]?this.colors[e]:(t=e.match(this.rgbRegExp))?"#"+n(t[1])+n(t[2])+n(t[3]):""}}}(jQuery),function(e){elRTE.prototype.w3cRange=function(e){var t=this;this.rte=e,this.r=null,this.collapsed=!0,this.startContainer=null,this.endContainer=null,this.startOffset=0,this.endOffset=0,this.commonAncestorContainer=null,this.range=function(){try{this.r=this.rte.window.document.selection.createRange()}catch(e){this.r=this.rte.doc.body.createTextRange()}return this.r},this.insertNode=function(e){this.range(),t.r.collapse(!1);var n=t.r.duplicate();n.pasteHTML(e)},this.getBookmark=function(){this.range();if(this.r.item){var e=this.r.item(0);this.r=this.rte.doc.body.createTextRange(),this.r.moveToElementText(e)}return this.r.getBookmark()},this.moveToBookmark=function(e){this.rte.window.focus(),this.range().moveToBookmark(e),this.r.select()},this.update=function(){function e(e){var n="﻿",r=offset=0,i=t.r.duplicate();i.collapse(e);var s=i.parentElement();if(!s||s.nodeName=="HTML")return{parent:t.rte.doc.body,ndx:r,offset:offset};i.pasteHTML(n),childs=s.childNodes;for(var o=0;o<childs.length;o++){var u=childs[o];o>0&&(u.nodeType!==3||childs[o-1].nodeType!==3)&&r++;if(u.nodeType!==3)offset=0;else{var a=u.nodeValue.indexOf(n);if(a!==-1){offset+=a;break}offset+=u.nodeValue.length}}return i.moveStart("character",-1),i.text="",{parent:s,ndx:Math.min(r,s.childNodes.length-1),offset:offset}}this.range(),this.startContainer=this.endContainer=null;if(this.r.item){this.collapsed=!1;var n=this.r.item(0);this.setStart(n.parentNode,this.rte.dom.indexOf(n)),this.setEnd(n.parentNode,this.startOffset+1)}else{this.collapsed=this.r.boundingWidth==0;var r=e(!0),i=e(!1);r.parent.normalize(),i.parent.normalize(),r.ndx=Math.min(r.ndx,r.parent.childNodes.length-1),i.ndx=Math.min(i.ndx,i.parent.childNodes.length-1),r.parent.childNodes[r.ndx].nodeType&&r.parent.childNodes[r.ndx].nodeType==1?this.setStart(r.parent,r.ndx):this.setStart(r.parent.childNodes[r.ndx],r.offset),i.parent.childNodes[i.ndx].nodeType&&i.parent.childNodes[i.ndx].nodeType==1?this.setEnd(i.parent,i.ndx):this.setEnd(i.parent.childNodes[i.ndx],i.offset),this.select()}return this},this.isCollapsed=function(){return this.range(),this.collapsed=this.r.item?!1:this.r.boundingWidth==0,this.collapsed},this.collapse=function(e){this.range();if(this.r.item){var t=this.r.item(0);this.r=this.rte.doc.body.createTextRange(),this.r.moveToElementText(t)}this.r.collapse(e),this.r.select(),this.collapsed=!0},this.getStart=function(){this.range();if(this.r.item)return this.r.item(0);var e=this.r.duplicate();e.collapse(!0);var t=e.parentElement();return t&&t.nodeName=="BODY"?t.firstChild:t},this.getEnd=function(){this.range();if(this.r.item)return this.r.item(0);var e=this.r.duplicate();e.collapse(!1);var t=e.parentElement();return t&&t.nodeName=="BODY"?t.lastChild:t},this.setStart=function(e,t){this.startContainer=e,this.startOffset=t,this.endContainer&&(this.commonAncestorContainer=this.rte.dom.findCommonAncestor(this.startContainer,this.endContainer))},this.setEnd=function(e,t){this.endContainer=e,this.endOffset=t,this.startContainer&&(this.commonAncestorContainer=this.rte.dom.findCommonAncestor(this.startContainer,this.endContainer))},this.setStartBefore=function(e){e.parentNode&&this.setStart(e.parentNode,this.rte.dom.indexOf(e))},this.setStartAfter=function(e){e.parentNode&&this.setStart(e.parentNode,this.rte.dom.indexOf(e)+1)},this.setEndBefore=function(e){e.parentNode&&this.setEnd(e.parentNode,this.rte.dom.indexOf(e))},this.setEndAfter=function(e){e.parentNode&&this.setEnd(e.parentNode,this.rte.dom.indexOf(e)+1)},this.select=function(){function e(e,n){if(e.nodeType!=3)return-1;var r="﻿",i=e.nodeValue,s=t.rte.doc.body.createTextRange();e.nodeValue=i.substring(0,n)+r+i.substring(n),s.moveToElementText(e.parentNode),s.findText(r);var o=Math.abs(s.moveStart("character",-1048575));return e.nodeValue=i,o}this.r=this.rte.doc.body.createTextRange();var n=this.startOffset,r=this.endOffset,i=this.startContainer.nodeType==1?this.startContainer.childNodes[Math.min(n,this.startContainer.childNodes.length-1)]:this.startContainer,s=this.endContainer.nodeType==1?this.endContainer.childNodes[Math.min(n==r?r:r-1,this.endContainer.childNodes.length-1)]:this.endContainer;if(this.collapsed)if(i.nodeType==3){var o=e(i,n);this.r.move("character",o)}else this.r.moveToElementText(i),this.r.collapse(!0);else{var u=this.rte.doc.body.createTextRange(),a=e(i,n),f=e(s,r);i.nodeType==3?this.r.move("character",a):this.r.moveToElementText(i),s.nodeType==3?u.move("character",f):u.moveToElementText(s),this.r.setEndPoint("EndToEnd",u)}try{this.r.select()}catch(s){}u&&(u=null)},this.dump=function(){this.rte.log("collapsed: "+this.collapsed),this.rte.log("startContainer: "+(this.startContainer?this.startContainer.nodeName:"non")),this.rte.log("startOffset: "+this.startOffset),this.rte.log("endContainer: "+(this.endContainer?this.endContainer.nodeName:"none")),this.rte.log("endOffset: "+this.endOffset)}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.about=function(t,n){this.constructor.prototype.constructor.call(this,t,n),this.active=!0,this.command=function(){var n,r,i;n={rtl:t.rtl,submit:function(e,t){t.close()},dialog:{width:560,title:this.rte.i18n("About this software"),buttons:{Ok:function(){e(this).dialog("destroy")}}}},i='<div class="elrte-logo"></div><h3>'+this.rte.i18n("About elRTE")+'</h3><br clear="all"/><div class="elrte-ver">'+this.rte.i18n("Version")+": "+this.rte.version+" ("+this.rte.build+')</div><div class="elrte-ver">jQuery: '+e("<div/>").jquery+'</div><div class="elrte-ver">jQueryUI: '+e.ui.version+'</div><div class="elrte-ver">'+this.rte.i18n("Licence")+": BSD Licence</div><p>"+this.rte.i18n("elRTE is an open-source JavaScript based WYSIWYG HTML-editor.")+"<br/>"+this.rte.i18n("Main goal of the editor - simplify work with text and formating (HTML) on sites, blogs, forums and other online services.")+"<br/>"+this.rte.i18n("You can use it in any commercial or non-commercial projects.")+"</p><h4>"+this.rte.i18n("Authors")+'</h4><table class="elrte-authors"><tr><td>Dmitry (dio) Levashov &lt;dio@std42.ru&gt;</td><td>'+this.rte.i18n("Chief developer")+"</td></tr><tr><td>Troex Nevelin &lt;troex@fury.scancode.ru&gt;</td><td>"+this.rte.i18n("Developer, tech support")+"</td></tr><tr><td>Valentin Razumnyh &lt;content@std42.ru&gt;</td><td>"+this.rte.i18n("Interface designer")+"</td></tr><tr><td>Tawfek Daghistani &lt;tawfekov@gmail.com&gt;</td><td>"+this.rte.i18n("RTL support")+"</td></tr>"+(this.rte.options.lang!="en"?"<tr><td>"+this.rte.i18n("_translator")+"</td><td>"+this.rte.i18n("_translation")+"</td></tr>":"")+'</table><div class="elrte-copy">Copyright &copy; 2009-2011, <a href="http://www.std42.ru">Studio 42</a></div><div class="elrte-copy">'+this.rte.i18n("For more information about this software visit the")+' <a href="http://elrte.org">'+this.rte.i18n("elRTE website")+'.</a></div><div class="elrte-copy">Twitter: <a href="http://twitter.com/elrte_elfinder">elrte_elfinder</a></div>',r=new elDialogForm(n),r.append(i),r.open()},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.anchor=function(t,n){this.constructor.prototype.constructor.call(this,t,n),this.input=e('<input type="text" />').attr("name","anchor").attr("size","16");var r=this;this.command=function(){var n={rtl:this.rte.rtl,submit:function(e,t){e.stopPropagation(),e.preventDefault(),t.close(),r.set()},dialog:{title:this.rte.i18n("Bookmark")}};this.anchor=this.rte.dom.selfOrParentAnchor(this.rte.selection.getEnd())||t.dom.create("a"),!this.rte.selection.collapsed()&&this.rte.selection.collapse(!1),this.input.val(e(this.anchor).addClass("elrte-anchor").attr("name")),this.rte.selection.saveIERange();var i=new elDialogForm(n);i.append([this.rte.i18n("Bookmark name"),this.input],null,!0).open(),setTimeout(function(){r.input.focus()},20)},this.update=function(){var e=this.rte.selection.getNode();this.rte.dom.selfOrParentLink(e)?this.domElem.addClass("disabled"):this.rte.dom.selfOrParentAnchor(e)?this.domElem.removeClass("disabled").addClass("active"):this.domElem.removeClass("disabled").removeClass("active")},this.set=function(){var t=e.trim(this.input.val());t?(this.rte.history.add(),this.anchor.parentNode?(this.anchor.name=t,this.anchor.title=this.rte.i18n("Bookmark")+": "+t):this.rte.selection.insertHtml('<a name="'+t+'" title="'+this.rte.i18n("Bookmark")+": "+t+'" class="elrte-anchor"></a>')):this.anchor.parentNode&&(this.rte.history.add(),this.anchor.parentNode.removeChild(this.anchor))}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.blockquote=function(t,n){this.constructor.prototype.constructor.call(this,t,n),this.command=function(){var t,n;this.rte.history.add(),this.rte.selection.collapsed()&&(t=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^BLOCKQUOTE$/))?e(t).replaceWith(e(t).html()):(n=this.rte.selection.selected({wrap:"all",tag:"blockquote"}),n.length&&this.rte.selection.select(n[0],n[n.length-1])),this.rte.ui.update(!0)},this.update=function(){this.rte.selection.collapsed()?this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^BLOCKQUOTE$/)?this.domElem.removeClass("disabled").addClass("active"):this.domElem.addClass("disabled").removeClass("active"):this.domElem.removeClass("disabled active")}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.copy=function(t,n){this.constructor.prototype.constructor.call(this,t,n),this.command=function(){if(this.rte.browser.mozilla)try{this.rte.doc.execCommand(this.name,!1,null)}catch(t){var n=" Ctl + C";this.name=="cut"?n=" Ctl + X":this.name=="paste"&&(n=" Ctl + V");var r={dialog:{title:this.rte.i18n("Warning"),buttons:{Ok:function(){e(this).dialog("close")}}}},i=new elDialogForm(r);i.append(this.rte.i18n("This operation is disabled in your browser on security reason. Use shortcut instead.")+": "+n).open()}else this.constructor.prototype.command.call(this)}},elRTE.prototype.ui.prototype.buttons.cut=elRTE.prototype.ui.prototype.buttons.copy,elRTE.prototype.ui.prototype.buttons.paste=elRTE.prototype.ui.prototype.buttons.copy}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.css=function(t,n){var r=this;this.constructor.prototype.constructor.call(this,t,n),this.cssStyle=e('<input type="text" size="42" name="style" />'),this.cssClass=e('<input type="text" size="42" name="class" />'),this.elementID=e('<input type="text" size="42" name="id" />'),this.command=function(){var t=this.node(),n;this.rte.selection.saveIERange();if(t){var n={submit:function(e,t){e.stopPropagation(),e.preventDefault(),t.close(),r.set()},dialog:{title:this.rte.i18n("Style"),width:450,resizable:!0,modal:!0}};this.cssStyle.val(e(t).attr("style")),this.cssClass.val(e(t).attr("class")),this.elementID.val(e(t).attr("id"));var i=new elDialogForm(n);i.append([this.rte.i18n("Css style"),this.cssStyle],null,!0),i.append([this.rte.i18n("Css class"),this.cssClass],null,!0),i.append([this.rte.i18n("ID"),this.elementID],null,!0),i.open(),setTimeout(function(){r.cssStyle.focus()},20)}},this.set=function(){var t=this.node();this.rte.selection.restoreIERange(),t&&(e(t).attr("style",this.cssStyle.val()),e(t).attr("class",this.cssClass.val()),e(t).attr("id",this.elementID.val()),this.rte.ui.update())},this.node=function(){var e=this.rte.selection.getNode();return e.nodeType==3&&(e=e.parentNode),e.nodeType==1&&e.nodeName!="BODY"?e:null},this.update=function(){this.domElem.toggleClass("disabled",this.node()?!1:!0)}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.rtl=function(t,n){this.constructor.prototype.constructor.call(this,t,n);var r=this;this.command=function(){var t=this.rte.selection.getNode(),n=this;e(t).attr("dir")=="rtl"||e(t).parents('[dir="rtl"]').length||e(t).find('[dir="rtl"]').length?(e(t).removeAttr("dir"),e(t).parents('[dir="rtl"]').removeAttr("dir"),e(t).find('[dir="rtl"]').removeAttr("dir")):this.rte.dom.is(t,"textNodes")&&this.rte.dom.is(t,"block")?e(t).attr("dir","rtl"):e.each(this.rte.dom.parents(t,"textNodes"),function(t,r){if(n.rte.dom.is(r,"block"))return e(r).attr("dir","rtl"),!1}),this.rte.ui.update()},this.update=function(){var t=this.rte.selection.getNode();this.domElem.removeClass("disabled"),e(t).attr("dir")=="rtl"||e(t).parents('[dir="rtl"]').length||e(t).find('[dir="rtl"]').length?this.domElem.addClass("active"):this.domElem.removeClass("active")}},elRTE.prototype.ui.prototype.buttons.ltr=function(t,n){this.constructor.prototype.constructor.call(this,t,n);var r=this;this.command=function(){var t=this.rte.selection.getNode(),n=this;e(t).attr("dir")=="ltr"||e(t).parents('[dir="ltr"]').length||e(t).find('[dir="ltr"]').length?(e(t).removeAttr("dir"),e(t).parents('[dir="ltr"]').removeAttr("dir"),e(t).find('[dir="ltr"]').removeAttr("dir")):this.rte.dom.is(t,"textNodes")&&this.rte.dom.is(t,"block")?e(t).attr("dir","ltr"):e.each(this.rte.dom.parents(t,"textNodes"),function(t,r){if(n.rte.dom.is(r,"block"))return e(r).attr("dir","ltr"),!1}),this.rte.ui.update()},this.update=function(){var t=this.rte.selection.getNode();this.domElem.removeClass("disabled"),e(t).attr("dir")=="ltr"||e(t).parents('[dir="ltr"]').length||e(t).find('[dir="ltr"]').length?this.domElem.addClass("active"):this.domElem.removeClass("active")}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.div=function(t,n){this.constructor.prototype.constructor.call(this,t,n),this.command=function(){var t,n;this.rte.history.add(),this.rte.selection.collapsed()?(t=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^DIV$/),t&&e(t).replaceWith(e(t).html())):(n=this.rte.selection.selected({wrap:"all",tag:"div"}),n.length&&this.rte.selection.select(n[0],n[n.length-1])),this.rte.ui.update(!0)},this.update=function(){this.rte.selection.collapsed()?this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^DIV$/)?this.domElem.removeClass("disabled").addClass("active"):this.domElem.addClass("disabled active"):this.domElem.removeClass("disabled active")}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.docstructure=function(t,n){this.constructor.prototype.constructor.call(this,t,n),this.command=function(){this.domElem.toggleClass("active"),e(this.rte.doc.body).toggleClass("el-rte-structure")},this.command(),this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.elfinder=function(e,t){this.constructor.prototype.constructor.call(this,e,t);var n=this,e=this.rte;this.command=function(){n.rte.options.fmAllow&&typeof n.rte.options.fmOpen=="function"&&n.rte.options.fmOpen(function(t){var n=decodeURIComponent(t.split("/").pop().replace(/\+/g," "));e.selection.collapsed()?e.selection.insertHtml('<a href="'+t+'" >'+n+"</a>"):e.doc.execCommand("createLink",!1,t)})},this.update=function(){n.rte.options.fmAllow&&typeof n.rte.options.fmOpen=="function"?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.flash=function(t,n){this.constructor.prototype.constructor.call(this,t,n);var r=this;this.swf=null,this.placeholder=null,this.src={url:e('<input type="text" name="url" />').css("width","99%"),type:e('<select name="type"/>').append('<option value="application/x-shockwave-flash">Flash</option>').append('<option value="video/quicktime">Quicktime movie</option>').append('<option value="application/x-mplayer2">Windows media</option>'),width:e('<input type="text" />').attr("size",5).css("text-align","right"),height:e('<input type="text" />').attr("size",5).css("text-align","right"),wmode:e("<select />").append(e("<option />").val("").text(this.rte.i18n("Not set","dialogs"))).append(e("<option />").val("transparent").text(this.rte.i18n("Transparent"))),align:e("<select />").append(e("<option />").val("").text(this.rte.i18n("Not set","dialogs"))).append(e("<option />").val("left").text(this.rte.i18n("Left"))).append(e("<option />").val("right").text(this.rte.i18n("Right"))).append(e("<option />").val("top").text(this.rte.i18n("Top"))).append(e("<option />").val("text-top").text(this.rte.i18n("Text top"))).append(e("<option />").val("middle").text(this.rte.i18n("middle"))).append(e("<option />").val("baseline").text(this.rte.i18n("Baseline"))).append(e("<option />").val("bottom").text(this.rte.i18n("Bottom"))).append(e("<option />").val("text-bottom").text(this.rte.i18n("Text bottom"))),margin:e("<div />")},this.command=function(){var t=this.rte.selection.getEnd(),n,i="",s="",o="",u,f,c,h,p,d;this.rte.selection.saveIERange(),this.src.margin.elPaddingInput({type:"margin"}),this.placeholder=null,this.swf=null;if(e(t).hasClass("elrte-media")&&(h=e(t).attr("rel"))&&this.rte.filter.scripts[h]){this.placeholder=e(t),p=this.rte.filter.scripts[h],i="",p.embed&&p.embed.src&&(i=p.embed.src);if(p.params&&p.params.length){l=p.params.length;while(l--)if(p.params[l].name=="src"||p.params[l].name=="movie")i=p.params[l].value}p.embed?(s=p.embed.width||parseInt(p.embed.style.width)||"",o=p.embed.height||parseInt(p.embed.style.height)||"",d=p.embed.wmode||""):p.obj&&(s=p.obj.width||parseInt(p.obj.style.width)||"",o=p.obj.height||parseInt(p.obj.style.height)||"",d=p.obj.wmode||""),p.obj?(u=p.obj.style["float"]||"",f=p.obj.style["vertical-align"]||""):p.embed&&(u=p.embed.style["float"]||"",f=p.embed.style["vertical-align"]||""),this.src.margin.val(t),this.src.type.val(p.embed?p.embed.type:"")}e(t).hasClass("elrte-swf-placeholder")&&(this.placeholder=e(t),i=e(t).attr("rel"),s=parseInt(e(t).css("width"))||"",o=parseInt(e(t).css("height"))||"",u=e(t).css("float"),f=e(t).css("vertical-align"),this.src.margin.val(t),this.src.wmode.val(e(t).attr("wmode"))),this.src.url.val(i),this.src.width.val(s),this.src.height.val(o),this.src.align.val(u||f),this.src.wmode.val(d);var n={rtl:this.rte.rtl,submit:function(e,t){e.stopPropagation(),e.preventDefault(),r.set(),t.close()},dialog:{width:580,position:"top",title:this.rte.i18n("Flash")}},c=new elDialogForm(n);if(this.rte.options.fmAllow&&this.rte.options.fmOpen)var v=e("<span />").append(this.src.url.css("width","85%")).append(e("<span />").addClass("ui-state-default ui-corner-all").css({"float":"right","margin-right":"3px"}).attr("title",r.rte.i18n("Open file manger")).append(e("<span />").addClass("ui-icon ui-icon-folder-open")).click(function(){r.rte.options.fmOpen(function(e){r.src.url.val(e).change()})}).hover(function(){e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")}));else var v=this.src.url;c.append([this.rte.i18n("URL"),v],null,!0),c.append([this.rte.i18n("Type"),this.src.type],null,!0),c.append([this.rte.i18n("Size"),e("<span />").append(this.src.width).append(" x ").append(this.src.height).append(" px")],null,!0),c.append([this.rte.i18n("Wmode"),this.src.wmode],null,!0),c.append([this.rte.i18n("Alignment"),this.src.align],null,!0),c.append([this.rte.i18n("Margins"),this.src.margin],null,!0),c.open();var m=e("<fieldset />").append(e("<legend />").text(this.rte.i18n("Preview")));c.append(m,"main");var g=document.createElement("iframe");e(g).attr("src","#").addClass("el-rte-preview").appendTo(m),html=this.rte.options.doctype+'<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /></head><body style="padding:0;margin:0;font-size:9px"> Proin elit arcu, rutrum commodo, vehicula tempus, commodo a, risus. Curabitur nec arcu. Donec sollicitudin mi sit amet mauris. Nam elementum quam ullamcorper ante. Etiam aliquet massa et lorem. Mauris dapibus lacus auctor risus. Aenean tempor ullamcorper leo. Vivamus sed magna quis ligula eleifend adipiscing. Duis orci. Aliquam sodales tortor vitae ipsum. Aliquam nulla. Duis aliquam molestie erat. Ut et mauris vel pede varius sollicitudin</body></html>',g.contentWindow.document.open(),g.contentWindow.document.write(html),g.contentWindow.document.close(),this.frame=g.contentWindow.document,this.preview=e(g.contentWindow.document.body),this.src.type.change(function(){r.src.url.change()}),this.src.width.change(function(){if(r.swf){var t=parseInt(e(this).val())||"";e(this).val(t),r.swf.css("width",t),r.swf.children("embed").css("width",t)}else e(this).val("")}),this.src.height.change(function(){if(r.swf){var t=parseInt(e(this).val())||"";e(this).val(t),r.swf.css("height",t),r.swf.children("embed").css("height",t)}else e(this).val("")}),this.src.wmode.change(function(){if(r.swf){var t=e(this).val();t?(r.swf.attr("wmode",t),r.swf.children("embed").attr("wmode",t)):(r.swf.removeAttr("wmode"),r.swf.children("embed").removeAttr("wmode"))}}),this.src.align.change(function(){var t=e(this).val(),n=t=="left"||t=="right";r.swf?r.swf.css({"float":n?t:"","vertical-align":n?"":t}):e(this).val("")}),this.src.margin.change(function(){if(r.swf){var e=r.src.margin.val();e.css?r.swf.css("margin",e.css):(r.swf.css("margin-top",e.top),r.swf.css("margin-right",e.right),r.swf.css("margin-bottom",e.bottom),r.swf.css("margin-left",e.left))}}),this.src.url.change(function(){var t=r.rte.utils.absoluteURL(e(this).val()),n,i;t?(n=r.rte.utils.mediaInfo(r.src.type.val()),n||(n=r.rte.util.mediaInfo("application/x-shockwave-flash")),i='<object classid="'+n.classid+'" codebase="'+n.codebase+'"><param name="src" value="'+t+'" /><embed quality="high" src="'+t+'" type="'+n.type+'"></object>',r.preview.children("object").remove().end().prepend(i),r.swf=r.preview.children("object").eq(0)):r.swf&&(r.swf.remove(),r.swf=null),r.src.width.trigger("change"),r.src.height.trigger("change"),r.src.align.trigger("change")}).trigger("change")},this.set=function(){r.swf=null;var t=this.rte.utils.absoluteURL(this.src.url.val()),n=parseInt(this.src.width.val())||"",s=parseInt(this.src.height.val())||"",o=this.src.wmode.val(),u=this.src.align.val(),f=u=="left"||u=="right"?u:"",l=this.placeholder?this.placeholder.attr("rel"):"",c,h,p,d=this.src.margin.val(),v;if(!t)this.placeholder&&(this.placeholder.remove(),delete this.rte.filter.scripts[l]);else{i=r.rte.utils.mediaInfo(r.src.type.val()),i||(i=r.rte.util.mediaInfo("application/x-shockwave-flash")),p=this.rte.filter.videoHostRegExp.test(t)?t.replace(this.rte.filter.videoHostRegExp,"$2"):i.type.replace(/^\w+\/(.+)/,"$1"),c={obj:{classid:i.classid[0],codebase:i.codebase,style:{}},params:[{name:"src",value:t}],embed:{src:t,type:i.type,quality:"high",wmode:o,style:{}}},n&&(c.obj.width=n,c.embed.width=n),s&&(c.obj.height=s,c.embed.height=s),f?c.obj.style["float"]=f:u&&(c.obj.style["vertical-align"]=u),d.css?v={margin:d.css}:v={"margin-top":d.top,"margin-right":d.right,"margin-bottom":d.bottom,"margin-left":d.left},c.obj.style=e.extend({},c.obj.style,v);if(this.placeholder&&l)h=this.rte.filter.scripts[l]||{},c=e.extend(!0,h,c),delete c.obj.style.width,delete c.obj.style.height,delete c.embed.style.width,delete c.embed.style.height,this.rte.filter.scripts[l]=c,this.placeholder.removeAttr("class");else{var m="media"+Math.random().toString().substring(2);this.rte.filter.scripts[m]=c,this.placeholder=e(this.rte.dom.create("img")).attr("rel",m).attr("src",this.rte.filter.url+"pixel.gif");var g=!0}this.placeholder.attr("title",this.rte.utils.encode(t)).attr("width",n||150).attr("height",s||100).addClass("elrte-protected elrte-media elrte-media-"+p).css(c.obj.style),f?this.placeholder.css("float",f).css("vertical-align",""):u?this.placeholder.css("float","").css("vertical-align",u):this.placeholder.css("float","").css("vertical-align",""),g&&(this.rte.window.focus(),this.rte.selection.restoreIERange(),this.rte.selection.insertNode(this.placeholder.get(0)))}},this.update=function(){this.domElem.removeClass("disabled");var t=this.rte.selection.getNode();this.domElem.toggleClass("active",t&&t.nodeName=="IMG"&&e(t).hasClass("elrte-media"))}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.fontname=function(t,n){this.constructor.prototype.constructor.call(this,t,n);var r=this,i={tpl:'<span style="font-family:%val">%label</span>',select:function(e){r.set(e)},src:{"":this.rte.i18n("Font"),"andale mono,sans-serif":"Andale Mono","arial,helvetica,sans-serif":"Arial","arial black,gadget,sans-serif":"Arial Black","book antiqua,palatino,sans-serif":"Book Antiqua","comic sans ms,cursive":"Comic Sans MS","courier new,courier,monospace":"Courier New","georgia,palatino,serif":"Georgia","helvetica,sans-serif":"Helvetica","impact,sans-serif":"Impact","lucida console,monaco,monospace":"Lucida console","lucida sans unicode,lucida grande,sans-serif":"Lucida grande","tahoma,sans-serif":"Tahoma","times new roman,times,serif":"Times New Roman","trebuchet ms,lucida grande,verdana,sans-serif":"Trebuchet MS","verdana,geneva,sans-serif":"Verdana"}};this.select=this.domElem.elSelect(i),this.command=function(){},this.set=function(t){this.rte.history.add();var n=this.rte.selection.selected({filter:"textContainsNodes"});e.each(n,function(){$this=/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(this.nodeName)?e(this).find("td,th"):e(this),e(this).css("font-family",t).find("[style]").css("font-family","")}),this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled");var t=this.rte.selection.getNode();t.nodeType!=1&&(t=t.parentNode);var n=e(t).css("font-family");n=n?n.toString().toLowerCase().replace(/,\s+/g,",").replace(/'|"/g,""):"",this.select.val(i.src[n]?n:"")}}}(jQuery),function(
e){elRTE.prototype.ui.prototype.buttons.fontsize=function(t,n){this.constructor.prototype.constructor.call(this,t,n);var r=this,i={labelTpl:"%label",tpl:'<span style="font-size:%val;line-height:1.2em">%label</span>',select:function(e){r.set(e)},src:{"":this.rte.i18n("Font size"),"xx-small":this.rte.i18n("Small (8pt)"),"x-small":this.rte.i18n("Small (10px)"),small:this.rte.i18n("Small (12pt)"),medium:this.rte.i18n("Normal (14pt)"),large:this.rte.i18n("Large (18pt)"),"x-large":this.rte.i18n("Large (24pt)"),"xx-large":this.rte.i18n("Large (36pt)")}};this.select=this.domElem.elSelect(i),this.command=function(){},this.set=function(t){this.rte.history.add();var n=this.rte.selection.selected({filter:"textContainsNodes"});e.each(n,function(){$this=/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(this.nodeName)?e(this).find("td,th"):e(this),$this.css("font-size",t).find("[style]").css("font-size","")}),this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled");var e=this.rte.selection.getNode();this.select.val((m=this.rte.dom.attr(e,"style").match(/font-size:\s*([^;]+)/i))?m[1]:"")}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.forecolor=function(t,n){var r=this;this.constructor.prototype.constructor.call(this,t,n);var i={"class":"",palettePosition:"outer",color:this.defaultColor,update:function(e){r.indicator.css("background-color",e)},change:function(e){r.set(e)}};this.defaultColor=this.name=="forecolor"?"#000000":"#ffffff",this.picker=this.domElem.elColorPicker(i),this.indicator=e("<div />").addClass("color-indicator").prependTo(this.domElem),this.command=function(){},this.set=function(t){if(!this.rte.selection.collapsed()){this.rte.history.add();var n=this.rte.selection.selected({collapse:!1,wrap:"text"}),r=this.name=="forecolor"?"color":"background-color";e.each(n,function(){/^(THEAD|TBODY|TFOOT|TR)$/.test(this.nodeName)?e(this).find("td,th").each(function(){e(this).css(r,t).find("*").css(r,"")}):e(this).css(r,t).find("*").css(r,"")}),this.rte.ui.update(!0)}},this.update=function(){this.domElem.removeClass("disabled");var t=this.rte.selection.getNode();this.picker.val(this.rte.utils.rgb2hex(e(t.nodeType!=1?t.parentNode:t).css(this.name=="forecolor"?"color":"background-color"))||this.defaultColor)}},elRTE.prototype.ui.prototype.buttons.hilitecolor=elRTE.prototype.ui.prototype.buttons.forecolor}(jQuery),function(t){elRTE.prototype.ui.prototype.buttons.formatblock=function(n,r){this.constructor.prototype.constructor.call(this,n,r);var i=this.rte.browser.msie?function(e){o.val=e,o.constructor.prototype.command.call(o)}:function(e){o.ieCommand(e)},o=this,u={labelTpl:"%label",tpls:{"":"%label"},select:function(e){o.formatBlock(e)},src:{span:this.rte.i18n("Format"),h1:this.rte.i18n("Heading 1"),h2:this.rte.i18n("Heading 2"),h3:this.rte.i18n("Heading 3"),h4:this.rte.i18n("Heading 4"),h5:this.rte.i18n("Heading 5"),h6:this.rte.i18n("Heading 6"),p:this.rte.i18n("Paragraph"),address:this.rte.i18n("Address"),pre:this.rte.i18n("Preformatted"),div:this.rte.i18n("Normal (DIV)")}};this.select=this.domElem.elSelect(u),this.command=function(){},this.formatBlock=function(n){function r(e,n){function r(e){return t(e).find("h1,h2,h3,h4,h5,h6,p,address,pre").each(function(){t(this).replaceWith(t(this).html())}),e}/^(LI|DT|DD|TD|TH|CAPTION)$/.test(e.nodeName)?!o.rte.dom.isEmpty(e)&&o.rte.dom.wrapContents(r(e),n):/^(UL|OL|DL|TABLE)$/.test(e.nodeName)?o.rte.dom.wrap(e,n):!o.rte.dom.isEmpty(e)&&t(r(e)).replaceWith(t(o.rte.dom.create(n)).html(t(e).html()))}this.rte.history.add();var i=n.toUpperCase(),u,f,c,h=this.rte.selection.collapsed(),p=this.rte.selection.getBookmark(),d=this.rte.selection.selected({collapsed:!0,blocks:!0,filter:"textContainsNodes",wrap:"inline",tag:"span"});l=d.length,s=t(d[0]).prev(),e=t(d[d.length-1]).next();while(l--)f=d[l],c=t(f),i=="DIV"||i=="SPAN"?/^(H[1-6]|P|ADDRESS|PRE)$/.test(f.nodeName)&&c.replaceWith(t(this.rte.dom.create("div")).html(c.html()||"")):/^(THEAD|TBODY|TFOOT|TR)$/.test(f.nodeName)?c.find("td,th").each(function(){r(this,i)}):f.nodeName!=i&&r(f,i);this.rte.selection.moveToBookmark(p),this.rte.ui.update(!0)},this.update=function(){this.domElem.removeClass("disabled");var e=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(H[1-6]|P|ADDRESS|PRE)$/);this.select.val(e?e.nodeName.toLowerCase():"span")}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.fullscreen=function(t,n){function i(){r.wz.height(e(window).height()-r.delta),r.rte.updateHeight()}var r=this;this.constructor.prototype.constructor.call(this,t,n),this.active=!0,this.editor=t.editor,this.wz=t.workzone,this.height=0,this.delta=0,this._class="el-fullscreen",setTimeout(function(){r.height=r.wz.height(),r.delta=r.editor.outerHeight()-r.height},50),this.command=function(){function m(){p&&(d=h.getBookmark())}function g(){p&&(r.wz.children().toggle(),r.rte.source.focus(),r.wz.children().toggle(),h.moveToBookmark(d))}var t=e(window),n=this.editor,s=n.parents().filter(function(t,n){return!/^(html|body)$/i.test(n.nodeName)&&e(n).css("position")=="relative"}),o=this.wz,u=this._class,f=n.hasClass(u),l=this.rte,h=this.rte.selection,p=e.browser.mozilla,d,v;m(),s.css("position",f?"relative":"static"),f?(n.removeClass(u),o.height(this.height),t.unbind("resize",i),this.domElem.removeClass("active")):(n.addClass(u).removeAttr("style"),o.height(t.height()-this.delta).css("width","100%"),t.bind("resize",i),this.domElem.addClass("active")),l.updateHeight(),l.resizable(f),g()},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.horizontalrule=function(t,n){this.constructor.prototype.constructor.call(this,t,n);var r=this;this.src={width:e('<input type="text" />').attr({name:"width",size:4}).css("text-align","right"),wunit:e("<select />").attr("name","wunit").append(e("<option />").val("%").text("%")).append(e("<option />").val("px").text("px")).val("%"),height:e('<input type="text" />').attr({name:"height",size:4}).css("text-align","right"),bg:e("<div />"),border:e("<div />"),"class":e('<input type="text" />').css("width","100%"),style:e('<input type="text" />').css("width","100%")},this.command=function(){this.src.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"});var n=this.rte.selection.getEnd();this.hr=n.nodeName=="HR"?e(n):e(t.doc.createElement("hr")).css({width:"100%",height:"1px"}),this.src.border.elBorderSelect({styleHeight:73,value:this.hr});var i=this.hr.css("width")||this.hr.attr("width");this.src.width.val(parseInt(i)||100),this.src.wunit.val(i.indexOf("px")!=-1?"px":"%"),this.src.height.val(this.rte.utils.toPixels(this.hr.css("height")||this.hr.attr("height"))||1),this.src.bg.val(this.rte.utils.color2Hex(this.hr.css("background-color"))),this.src["class"].val(this.rte.dom.attr(this.hr,"class")),this.src.style.val(this.rte.dom.attr(this.hr,"style"));var s={rtl:this.rte.rtl,submit:function(e,t){e.stopPropagation(),e.preventDefault(),r.set(),t.close()},dialog:{title:this.rte.i18n("Horizontal rule")}},o=new elDialogForm(s);o.append([this.rte.i18n("Width"),e("<span />").append(this.src.width).append(this.src.wunit)],null,!0).append([this.rte.i18n("Height"),e("<span />").append(this.src.height).append(" px")],null,!0).append([this.rte.i18n("Border"),this.src.border],null,!0).append([this.rte.i18n("Background"),this.src.bg],null,!0).append([this.rte.i18n("Css class"),this.src["class"]],null,!0).append([this.rte.i18n("Css style"),this.src.style],null,!0).open()},this.update=function(){this.domElem.removeClass("disabled"),this.rte.selection.getEnd().nodeName=="HR"?this.domElem.addClass("active"):this.domElem.removeClass("active")},this.set=function(){this.rte.history.add(),!this.hr.parentNode&&this.rte.selection.insertNode(this.hr.get(0));var e={noshade:!0,style:this.src.style.val()},t=this.src.border.val(),n={width:(parseInt(this.src.width.val())||100)+this.src.wunit.val(),height:parseInt(this.src.height.val())||1,"background-color":this.src.bg.val(),border:t.width&&t.style?t.width+" "+t.style+" "+t.color:""};this.hr.removeAttr("class").removeAttr("style").removeAttr("width").removeAttr("height").removeAttr("align").attr(e).css(n),this.src["class"].val()&&this.hr.attr("class",this.src["class"].val()),this.rte.ui.update()}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.image=function(t,n){this.constructor.prototype.constructor.call(this,t,n);var r=this,t=r.rte,i=0,s=0,o=0,u=null,f=function(t){e.each(r.src,function(n,r){e.each(r,function(e,n){if(e=="src"&&t)return;n.val("")})})},l=function(n){e.each(r.src,function(r,i){e.each(i,function(e,i){var s,o,u,a,f;e=="width"?s=n.width():e=="height"?s=n.height():e=="border"?(s="",f=n.css("border")||t.utils.parseStyle(n.attr("style")).border||"",f&&(o=f.match(/(\d(px|em|%))/),u=f.match(/(#[a-z0-9]+)/),s={width:o?o[1]:f,style:f,color:t.utils.color2Hex(u?u[1]:f)})):e=="margin"?s=n:e=="align"?(s=n.css("float"),s!="left"&&s!="right"&&(s=n.css("vertical-align"))):s=n.attr(e)||"",r=="events"&&(s=t.utils.trimEventCallback(s)),i.val(s)})})},c=function(){var t=r.src.main.src.val();f(!0),t?(r.prevImg?(r.prevImg.removeAttr("src").removeAttr("style").removeAttr("class").removeAttr("id").removeAttr("title").removeAttr("alt").removeAttr("longdesc"),e.each(r.src.events,function(e,t){r.prevImg.removeAttr(e)})):r.prevImg=e("<img/>").prependTo(r.preview),r.prevImg.load(function(){r.prevImg.unbind("load"),setTimeout(function(){s=r.prevImg.width(),o=r.prevImg.height(),i=(s/o).toFixed(2),r.src.main.width.val(s),r.src.main.height.val(o)},100)}).attr("src",t)):(r.preview.children("img").remove(),r.prevImg=null)},h=function(e){var t=parseInt(r.src.main.width.val())||0,n=parseInt(r.src.main.height.val())||0;r.prevImg&&(t&&n?e.target===r.src.main.width[0]?n=parseInt(t/i):t=parseInt(n*i):(t=s,n=o),r.src.main.height.val(n),r.src.main.width.val(t),r.prevImg.width(t).height(n),r.src.adv.style.val(r.prevImg.attr("style")))};this.img=null,this.prevImg=null,this.preview=e('<div class="elrte-image-preview"/>').text("Proin elit arcu, rutrum commodo, vehicula tempus, commodo a, risus. Curabitur nec arcu. Donec sollicitudin mi sit amet mauris. Nam elementum quam ullamcorper ante. Etiam aliquet massa et lorem. Mauris dapibus lacus auctor risus. Aenean tempor ullamcorper leo. Vivamus sed magna quis ligula eleifend adipiscing. Duis orci. Aliquam sodales tortor vitae ipsum. Aliquam nulla. Duis aliquam molestie erat. Ut et mauris vel pede varius sollicitudin"),this.init=function(){this.labels={main:"Properies",link:"Link",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",longdesc:"Detail description URL",href:"URL",target:"Open in",title:"Title"},this.src={main:{src:e('<input type="text" />').css("width","100%").change(c),title:e('<input type="text" />').css("width","100%"),alt:e('<input type="text" />').css("width","100%"),width:e('<input type="text" />').attr("size",5).css("text-align","right").change(h),height:e('<input type="text" />').attr("size",5).css("text-align","right").change(h),margin:e("<div />").elPaddingInput({type:"margin",change:function(){var e=r.src.main.margin.val();r.prevImg&&(e.css?r.prevImg.css("margin",e.css):r.prevImg.css({"margin-left":e.left,"margin-top":e.top,"margin-right":e.right,"margin-bottom":e.bottom}))}}),align:e("<select />").css("width","100%").append(e("<option />").val("").text(this.rte.i18n("Not set","dialogs"))).append(e("<option />").val("left").text(this.rte.i18n("Left"))).append(e("<option />").val("right").text(this.rte.i18n("Right"))).append(e("<option />").val("top").text(this.rte.i18n("Top"))).append(e("<option />").val("text-top").text(this.rte.i18n("Text top"))).append(e("<option />").val("middle").text(this.rte.i18n("middle"))).append(e("<option />").val("baseline").text(this.rte.i18n("Baseline"))).append(e("<option />").val("bottom").text(this.rte.i18n("Bottom"))).append(e("<option />").val("text-bottom").text(this.rte.i18n("Text bottom"))).change(function(){var t=e(this).val(),n={"float":"","vertical-align":""};r.prevImg&&(t=="left"||t=="right"?(n["float"]=t,n["vertical-align"]=""):t&&(n["float"]="",n["vertical-align"]=t),r.prevImg.css(n))}),border:e("<div />").elBorderSelect({name:"border",change:function(){var e=r.src.main.border.val();r.prevImg&&r.prevImg.css("border",e.width?e.width+" "+e.style+" "+e.color:"")}})},adv:{},events:{}},e.each(["id","class","style","longdesc"],function(t,n){r.src.adv[n]=e('<input type="text" style="width:100%" />')}),this.src.adv["class"].change(function(){r.prevImg&&r.prevImg.attr("class",e(this).val())}),this.src.adv.style.change(function(){r.prevImg&&(r.prevImg.attr("style",e(this).val()),l(r.prevImg))}),e.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){r.src.events[this]=e('<input type="text"  style="width:100%"/>')})},this.command=function(){!this.src&&this.init();var n,c={rtl:t.rtl,submit:function(e,t){e.stopPropagation(),e.preventDefault(),r.set(),h.close()},close:function(){u&&t.selection.moveToBookmark(u)},dialog:{autoOpen:!1,width:500,position:"top",title:t.i18n("Image"),resizable:!0,open:function(){e.fn.resizable&&e(this).parents(".ui-dialog:first").resizable("option","alsoResize",".elrte-image-preview")}}},h=new elDialogForm(c),d=!!t.options.fmOpen,v=d?e('<div class="elrte-image-src-fm"><span class="ui-state-default ui-corner-all"><span class="ui-icon ui-icon-folder-open"/></span></div>').append(this.src.main.src.css("width","87%")):this.src.main.src;f(),this.preview.children("img").remove(),this.prevImg=null,n=t.selection.getEnd(),this.img=n.nodeName=="IMG"&&!e(n).is(".elrte-protected")?e(n):e("<img/>"),u=t.selection.getBookmark(),d&&v.children(".ui-state-default").click(function(){t.options.fmOpen(function(e){r.src.main.src.val(e).change()})}).hover(function(){e(this).toggleClass("ui-state-hover")}),h.tab("main",this.rte.i18n("Properies")).append([this.rte.i18n("Image URL"),v],"main",!0).append([this.rte.i18n("Title"),this.src.main.title],"main",!0).append([this.rte.i18n("Alt text"),this.src.main.alt],"main",!0).append([this.rte.i18n("Size"),e("<span />").append(this.src.main.width).append(" x ").append(this.src.main.height).append(" px")],"main",!0).append([this.rte.i18n("Alignment"),this.src.main.align],"main",!0).append([this.rte.i18n("Margins"),this.src.main.margin],"main",!0).append([this.rte.i18n("Border"),this.src.main.border],"main",!0),h.append(e("<fieldset><legend>"+this.rte.i18n("Preview")+"</legend></fieldset>").append(this.preview),"main"),e.each(this.src,function(n,i){if(n=="main")return;h.tab(n,t.i18n(r.labels[n])),e.each(i,function(e,i){r.src[n][e].val(n=="events"?t.utils.trimEventCallback(r.img.attr(e)):r.img.attr(e)||""),h.append([t.i18n(r.labels[e]||e),r.src[n][e]],n,!0)})}),h.open(),this.img.attr("src")&&(l(this.img),this.prevImg=this.img.clone().prependTo(this.preview),i=(this.img.width()/this.img.height()).toFixed(2),s=parseInt(this.img.width()),o=parseInt(this.img.height()))},this.set=function(){var n=this.src.main.src.val(),i;this.rte.history.add(),u&&t.selection.moveToBookmark(u);if(!n)return i=t.dom.selfOrParentLink(this.img[0]),i&&i.remove(),this.img.remove();!this.img[0].parentNode&&(this.img=e(this.rte.doc.createElement("img"))),this.img.attr("src",n).attr("style",this.src.adv.style.val()),e.each(this.src,function(t,n){e.each(n,function(t,n){var i=n.val(),s;switch(t){case"width":r.img.css("width",i);break;case"height":r.img.css("height",i);break;case"align":r.img.css(i=="left"||i=="right"?"float":"vertical-align",i);break;case"margin":i.css?r.img.css("margin",i.css):r.img.css({"margin-left":i.left,"margin-top":i.top,"margin-right":i.right,"margin-bottom":i.bottom});break;case"border":if(!!i.width){i="border:"+i.css+";"+e.trim((r.img.attr("style")||"").replace(/border\-[^;]+;?/ig,"")),t="style",r.img.attr("style",i);return}i="";break;case"src":case"style":return;default:i?r.img.attr(t,i):r.img.removeAttr(t)}})}),!this.img[0].parentNode&&t.selection.insertNode(this.img[0]),this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled");var t=this.rte.selection.getEnd(),n=e(t);t.nodeName=="IMG"&&!n.hasClass("elrte-protected")?this.domElem.addClass("active"):this.domElem.removeClass("active")}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.indent=function(t,n){this.constructor.prototype.constructor.call(this,t,n);var r=this;this.command=function(){function n(t){var n=/(IMG|HR|TABLE|EMBED|OBJECT)/.test(t.nodeName)?"margin-left":"padding-left",i=r.rte.dom.attr(t,"style").indexOf(n)!=-1?parseInt(e(t).css(n))||0:0;e(t).css(n,i+40+"px")}this.rte.history.add();var t=this.rte.selection.selected({collapsed:!0,blocks:!0,wrap:"inline",tag:"p"});for(var i=0;i<t.length;i++)if(/^(TABLE|THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(t[i].nodeName))e(t[i]).find("td,th").each(function(){n(this)});else if(/^LI$/.test(t[i].nodeName)){var s=e(t[i]);e(this.rte.dom.create(t[i].parentNode.nodeName)).append(e(this.rte.dom.create("li")).html(s.html()||"")).appendTo(s.html("&nbsp;"))}else n(t[i]);this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.justifyleft=function(t,n){this.constructor.prototype.constructor.call(this,t,n),this.align=this.name=="justifyfull"?"justify":this.name.replace("justify",""),this.command=function(){var t=this.rte.selection.selected({collapsed:!0,blocks:!0,tag:"div"}),n=t.length;n&&this.rte.history.add();while(n--)this.rte.dom.filter(t[n],"textNodes")&&e(t[n]).css("text-align",this.align);this.rte.ui.update()},this.update=function(){var t=this.rte.selection.getNode(),n=t.nodeName=="BODY"?t:this.rte.dom.selfOrParent(t,"textNodes")||(t.parentNode&&t.parentNode.nodeName=="BODY"?t.parentNode:null);n?this.domElem.removeClass("disabled").toggleClass("active",e(n).css("text-align")==this.align):this.domElem.addClass("disabled")}},elRTE.prototype.ui.prototype.buttons.justifycenter=elRTE.prototype.ui.prototype.buttons.justifyleft,elRTE.prototype.ui.prototype.buttons.justifyright=elRTE.prototype.ui.prototype.buttons.justifyleft,elRTE.prototype.ui.prototype.buttons.justifyfull=elRTE.prototype.ui.prototype.buttons.justifyleft}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.link=function(t,n){function i(){r.labels={id:"ID","class":"Css class",style:"Css style",dir:"Script direction",lang:"Language",charset:"Charset",type:"Target MIME type",rel:"Relationship page to target (rel)",rev:"Relationship target to page (rev)",tabindex:"Tab index",accesskey:"Access key"},r.src={main:{href:e('<input type="text" />'),title:e('<input type="text" />'),anchor:e("<select />").attr("name","anchor"),target:e("<select />").append(e("<option />").text(r.rte.i18n("In this window")).val("")).append(e("<option />").text(r.rte.i18n("In new window (_blank)")).val("_blank"))},popup:{use:e('<input type="checkbox" />'),url:e('<input type="text" />').val("http://"),name:e('<input type="text" />'),width:e('<input type="text" />').attr({size:6,title:r.rte.i18n("Width")}).css("text-align","right"),height:e('<input type="text" />').attr({size:6,title:r.rte.i18n("Height")}).css("text-align","right"),left:e('<input type="text" />').attr({size:6,title:r.rte.i18n("Left")}).css("text-align","right"),top:e('<input type="text" />').attr({size:6,title:r.rte.i18n("Top")}).css("text-align","right"),location:e('<input type="checkbox" />'),menubar:e('<input type="checkbox" />'),toolbar:e('<input type="checkbox" />'),scrollbars:e('<input type="checkbox" />'),status:e('<input type="checkbox" />'),resizable:e('<input type="checkbox" />'),dependent:e('<input type="checkbox" />'),retfalse:e('<input type="checkbox" />').attr("checked",!0)},adv:{id:e('<input type="text" />'),"class":e('<input type="text" />'),style:e('<input type="text" />'),dir:e("<select />").append(e("<option />").text(r.rte.i18n("Not set")).val("")).append(e("<option />").text(r.rte.i18n("Left to right")).val("ltr")).append(e("<option />").text(r.rte.i18n("Right to left")).val("rtl")),lang:e('<input type="text" />'),charset:e('<input type="text" />'),type:e('<input type="text" />'),rel:e('<input type="text" />'),rev:e('<input type="text" />'),tabindex:e('<input type="text" />'),accesskey:e('<input type="text" />')},events:{}},e.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){r.src.events[this]=e('<input type="text" />')}),e.each(r.src,function(){for(var e in this){var t=this[e].attr("type");(!t||t=="text"&&!this[e].attr("size"))&&this[e].css("width","100%")}})}this.constructor.prototype.constructor.call(this,t,n);var r=this;this.img=!1,this.bm,this.command=function(){function v(e){return e.nodeName=="A"&&e.href}var t=this.rte.selection.getNode(),n,s,o,u,f,l,c,h,p;!this.src&&i(),this.bm=this.rte.selection.getBookmark(),this.link=this.rte.dom.selfOrParentLink(t);if(!this.link){n=e.browser.msie?this.rte.selection.selected():this.rte.selection.selected({wrap:!1});if(n.length){for(s=0;s<n.length;s++)if(v(n[s])){this.link=n[s];break}this.link||(this.link=this.rte.dom.parent(n[0],v)||this.rte.dom.parent(n[n.length-1],v))}}this.link=this.link?e(this.link):e(this.rte.doc.createElement("a")),this.img=t.nodeName=="IMG"?t:null,this.updatePopup(),this.src.main.anchor.empty(),e('a[href!=""][name]',this.rte.doc).each(function(){var t=e(this).attr("name");r.src.main.anchor.append(e("<option />").val(t).text(t))}),this.src.main.anchor.children().length&&this.src.main.anchor.prepend(e("<option />").val("").text(this.rte.i18n("Select bookmark"))).change(function(){var t=e(this).val();t&&r.src.main.href.val("#"+t)}),u={rtl:this.rte.rtl,submit:function(e,t){e.stopPropagation(),e.preventDefault(),r.set(),t.close()},tabs:{show:function(e,t){t.index==3&&r.updateOnclick()}},close:function(){r.rte.browser.msie&&r.rte.selection.restoreIERange()},dialog:{width:"auto",width:430,title:this.rte.i18n("Link")}},d=new elDialogForm(u),f=e("<div />").append(e("<label />").append(this.src.popup.location).append(this.rte.i18n("Location bar"))).append(e("<label />").append(this.src.popup.menubar).append(this.rte.i18n("Menu bar"))).append(e("<label />").append(this.src.popup.toolbar).append(this.rte.i18n("Toolbar"))).append(e("<label />").append(this.src.popup.scrollbars).append(this.rte.i18n("Scrollbars"))),l=e("<div />").append(e("<label />").append(this.src.popup.status).append(this.rte.i18n("Status bar"))).append(e("<label />").append(this.src.popup.resizable).append(this.rte.i18n("Resizable"))).append(e("<label />").append(this.src.popup.dependent).append(this.rte.i18n("Depedent"))).append(e("<label />").append(this.src.popup.retfalse).append(this.rte.i18n("Add return false"))),d.tab("main",this.rte.i18n("Properies")).tab("popup",this.rte.i18n("Popup")).tab("adv",this.rte.i18n("Advanced")).tab("events",this.rte.i18n("Events")).append(e("<label />").append(this.src.popup.use).append(this.rte.i18n("Open link in popup window")),"popup").separator("popup").append([this.rte.i18n("URL"),this.src.popup.url],"popup",!0).append([this.rte.i18n("Window name"),this.src.popup.name],"popup",!0).append([this.rte.i18n("Window size"),e("<span />").append(this.src.popup.width).append(" x ").append(this.src.popup.height).append(" px")],"popup",!0).append([this.rte.i18n("Window position"),e("<span />").append(this.src.popup.left).append(" x ").append(this.src.popup.top).append(" px")],"popup",!0).separator("popup").append([f,l],"popup",!0),c=this.link.get(0),h=this.rte.dom.attr(c,"href"),this.src.main.href.val(h).change(function(){e(this).val(r.rte.utils.absoluteURL(e(this).val()))});if(this.rte.options.fmAllow&&this.rte.options.fmOpen){var p=e("<span />").append(this.src.main.href.css("width","87%")).append(e("<span />").addClass("ui-state-default ui-corner-all").css({"float":"right","margin-right":"3px"}).attr("title",r.rte.i18n("Open file manger")).append(e("<span />").addClass("ui-icon ui-icon-folder-open")).click(function(){r.rte.options.fmOpen(function(e){r.src.main.href.val(e).change()})}).hover(function(){e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")}));d.append([this.rte.i18n("Link URL"),p],"main",!0)}else d.append([this.rte.i18n("Link URL"),this.src.main.href],"main",!0);this.src.main.href.change(),d.append([this.rte.i18n("Title"),this.src.main.title.val(this.rte.dom.attr(c,"title"))],"main",!0),this.src.main.anchor.children().length&&d.append([this.rte.i18n("Bookmark"),this.src.main.anchor.val(h)],"main",!0),(!this.rte.options.doctype.match(/xhtml/)||!this.rte.options.doctype.match(/strict/))&&d.append([this.rte.i18n("Target"),this.src.main.target.val(this.link.attr("target")||"")],"main",!0);for(var t in this.src.adv)this.src.adv[t].val(this.rte.dom.attr(c,t)),d.append([this.rte.i18n(this.labels[t]?this.labels[t]:t),this.src.adv[t]],"adv",!0);for(var t in this.src.events){var o=this.rte.utils.trimEventCallback(this.rte.dom.attr(c,t));this.src.events[t].val(o),d.append([this.rte.i18n(this.labels[t]?this.labels[t]:t),this.src.events[t]],"events",!0)}this.src.popup.use.change(function(){var t=e(this).attr("checked");e.each(r.src.popup,function(){e(this).attr("name")!="use"&&(t?e(this).removeAttr("disabled"):e(this).attr("disabled",!0))})}),this.src.popup.use.change(),d.open()},this.update=function(){var e=this.rte.selection.getNode();this.rte.dom.selfOrParentLink(e)?this.domElem.removeClass("disabled").addClass("active"):this.rte.dom.selectionHas(function(e){return e.nodeName=="A"&&e.href})?this.domElem.removeClass("disabled").addClass("active"):!this.rte.selection.collapsed()||e.nodeName=="IMG"?this.domElem.removeClass("disabled active"):this.domElem.addClass("disabled").removeClass("active")},this.updatePopup=function(){var t=""+this.link.attr("onclick");t.length>0&&(m=t.match(/window.open\('([^']+)',\s*'([^']*)',\s*'([^']*)'\s*.*\);\s*(return\s+false)?/))?(this.src.popup.use.attr("checked","on"),this.src.popup.url.val(m[1]),this.src.popup.name.val(m[2]),/location=yes/.test(m[3])&&this.src.popup.location.attr("checked",!0),/menubar=yes/.test(m[3])&&this.src.popup.menubar.attr("checked",!0),/toolbar=yes/.test(m[3])&&this.src.popup.toolbar.attr("checked",!0),/scrollbars=yes/.test(m[3])&&this.src.popup.scrollbars.attr("checked",!0),/status=yes/.test(m[3])&&this.src.popup.status.attr("checked",!0),/resizable=yes/.test(m[3])&&this.src.popup.resizable.attr("checked",!0),/dependent=yes/.test(m[3])&&this.src.popup.dependent.attr("checked",!0),(_m=m[3].match(/width=([^,]+)/))&&this.src.popup.width.val(_m[1]),(_m=m[3].match(/height=([^,]+)/))&&this.src.popup.height.val(_m[1]),(_m=m[3].match(/left=([^,]+)/))&&this.src.popup.left.val(_m[1]),(_m=m[3].match(/top=([^,]+)/))&&this.src.popup.top.val(_m[1]),m[4]&&this.src.popup.retfalse.attr("checked",!0)):e.each(this.src.popup,function(){var t=e(this);t.attr("type")=="text"?t.val(t.attr("name")=="url"?"http://":""):t.attr("name")=="retfalse"?this.attr("checked",!0):t.removeAttr("checked")})},this.updateOnclick=function(){var t=this.src.popup.url.val();if(this.src.popup.use.attr("checked")&&t){var n="";this.src.popup.location.attr("checked")&&(n+="location=yes,"),this.src.popup.menubar.attr("checked")&&(n+="menubar=yes,"),this.src.popup.toolbar.attr("checked")&&(n+="toolbar=yes,"),this.src.popup.scrollbars.attr("checked")&&(n+="scrollbars=yes,"),this.src.popup.status.attr("checked")&&(n+="status=yes,"),this.src.popup.resizable.attr("checked")&&(n+="resizable=yes,"),this.src.popup.dependent.attr("checked")&&(n+="dependent=yes,"),this.src.popup.width.val()&&(n+="width="+this.src.popup.width.val()+","),this.src.popup.height.val()&&(n+="height="+this.src.popup.height.val()+","),this.src.popup.left.val()&&(n+="left="+this.src.popup.left.val()+","),this.src.popup.top.val()&&(n+="top="+this.src.popup.top.val()+","),n.length>0&&(n=n.substring(0,n.length-1));var r=this.src.popup.retfalse.attr("checked")?"return false;":"",i="window.open('"+t+"', '"+e.trim(this.src.popup.name.val())+"', '"+n+"'); "+r;this.src.events.onclick.val(i),this.src.main.href.val()||this.src.main.href.val("#")}else{var s=this.src.events.onclick.val();s=s.replace(/window\.open\([^\)]+\)\s*;?\s*return\s*false\s*;?/i,""),this.src.events.onclick.val(s)}},this.set=function(){var t,n;this.updateOnclick(),this.rte.selection.moveToBookmark(this.bm),this.rte.history.add(),t=this.rte.utils.absoluteURL(this.src.main.href.val());if(!t){var r=this.rte.selection.getBookmark();this.rte.dom.unwrap(this.link[0]),this.rte.selection.moveToBookmark(r)}else{this.img&&this.img.parentNode?(this.link=e(this.rte.dom.create("a")).attr("href",t),this.rte.dom.wrap(this.img,this.link[0])):this.link[0].parentNode||(n="#--el-editor---"+Math.random(),this.rte.doc.execCommand("createLink",!1,n),this.link=e('a[href="'+n+'"]',this.rte.doc),this.link.each(function(){var t=e(this);!e.trim(t.html())&&!e.trim(t.text())&&t.replaceWith(t.text())})),this.src.main.href.val(t);for(var i in this.src)if(i!="popup")for(var s in this.src[i])if(s!="anchors"){var o=e.trim(this.src[i][s].val());o?this.link.attr(s,o):this.link.removeAttr(s)}this.img&&this.rte.selection.select(this.img)}this.rte.ui.update(!0)}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.nbsp=function(e,t){this.constructor.prototype.constructor.call(this,e,t),this.command=function(){this.rte.history.add(),this.rte.selection.insertHtml("&nbsp;",!0),this.rte.window.focus(),this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.outdent=function(t,n){this.constructor.prototype.constructor.call(this,t,n);var r=this;this.command=function(){var t=this.find();t.node&&(this.rte.history.add(),e(t.node).css(t.type,(t.val>40?t.val-40:0)+"px"),this.rte.ui.update())},this.find=function(t){function n(t){var n={type:"",val:0},i;if(i=r.rte.dom.attr(t,"style"))n.type=i.indexOf("padding-left")!=-1?"padding-left":i.indexOf("margin-left")!=-1?"margin-left":"",n.val=n.type?parseInt(e(t).css(n.type))||0:0;return n}var t=this.rte.selection.getNode(),i=n(t);return i.val?i.node=t:e.each(this.rte.dom.parents(t,"*"),function(){i=n(this);if(i.val)return i.node=this,i}),i},this.update=function(){var e=this.find();e.node?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.pagebreak=function(t,n){this.constructor.prototype.constructor.call(this,t,n),e(this.rte.doc.body).bind("mousedown",function(t){e(t.target).hasClass("elrte-pagebreak")&&t.preventDefault()}),this.command=function(){this.rte.selection.insertHtml('<img src="'+this.rte.filter.url+'pixel.gif" class="elrte-protected elrte-pagebreak"/>',!1)},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.pasteformattext=function(t,n){this.constructor.prototype.constructor.call(this,t,n),this.iframe=e(document.createElement("iframe")).addClass("el-rte-paste-input"),this.doc=null;var r=this;this.command=function(){this.rte.selection.saveIERange();var e=this,t={submit:function(t,n){t.stopPropagation(),t.preventDefault(),e.paste(),n.close()},dialog:{width:500,title:this.rte.i18n("Paste formatted text")}},n=new elDialogForm(t);n.append(this.iframe).open(),this.doc=this.iframe.get(0).contentWindow.document,html=this.rte.options.doctype+'<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />',html+="</head><body> <br /> </body></html>",this.doc.open(),this.doc.write(html),this.doc.close();if(!this.rte.browser.msie)try{this.doc.designMode="on"}catch(r){}else this.doc.body.contentEditable=!0;setTimeout(function(){e.iframe[0].contentWindow.focus()},50)},this.paste=function(){e(this.doc.body).find("[class]").removeAttr("class");var t=e.trim(e(this.doc.body).html());t&&(this.rte.history.add(),this.rte.selection.restoreIERange(),this.rte.selection.insertHtml(this.rte.filter.wysiwyg2wysiwyg(this.rte.filter.proccess("paste",t))),this.rte.ui.update(!0))},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.pastetext=function(t,n){this.constructor.prototype.constructor.call(this,t,n),this.input=e("<textarea />").addClass("el-rte-paste-input");var r=this;this.command=function(){this.rte.browser.msie&&this.rte.selection.saveIERange();var e={submit:function(e,t){e.stopPropagation(),e.preventDefault(),r.paste(),t.close()},dialog:{width:500,title:this.rte.i18n("Paste only text")}},t=new elDialogForm(e);t.append(this.input).open()},this.paste=function(){var t=e.trim(this.input.val());t&&(this.rte.history.add(),this.rte.browser.msie&&this
.rte.selection.restoreIERange(),this.rte.selection.insertText(t.replace(/\r?\n/g,"<br />"),!0),this.rte.ui.update(!0)),this.input.val("")},this.update=function(){this.domElem.removeClass("disabled")}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.save=function(e,t){this.constructor.prototype.constructor.call(this,e,t),this.active=!0,this.command=function(){this.rte.save()},this.update=function(){}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.smiley=function(t,n){this.constructor.prototype.constructor.call(this,t,n);var r=this;this.img=null,this.url=this.rte.filter.url+"smileys/",this.smileys={smile:"smile.png",happy:"happy.png",tongue:"tongue.png",surprised:"surprised.png",waii:"waii.png",wink:"wink.png",evilgrin:"evilgrin.png",grin:"grin.png",unhappy:"unhappy.png"},this.width=120,this.command=function(){var t=this,n=this.url,r,i,s;this.rte.browser.msie&&this.rte.selection.saveIERange(),i={dialog:{height:120,width:this.width,title:this.rte.i18n("Smiley"),buttons:{}}},r=new elDialogForm(i),e.each(this.smileys,function(i,s){r.append(e('<img src="'+n+s+'" title="'+i+'" id="'+i+'" class="el-rte-smiley"/>').click(function(){t.set(this.id,r)}))}),r.open()},this.update=function(){this.domElem.removeClass("disabled"),this.domElem.removeClass("active")},this.set=function(t,n){this.rte.browser.msie&&this.rte.selection.restoreIERange(),this.smileys[t]&&(this.img=e(this.rte.doc.createElement("img")),this.img.attr({src:this.url+this.smileys[t],title:t,alt:t}),this.rte.selection.insertNode(this.img.get(0)),this.rte.ui.update()),n.close()}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.stopfloat=function(t,n){this.constructor.prototype.constructor.call(this,t,n),this.find=function(){if(this.rte.selection.collapsed()){var t=this.rte.dom.selfOrParent(this.rte.selection.getEnd(),/^DIV$/);if(t&&(this.rte.dom.attr(t,"clear")||e(t).css("clear")!="none"))return t}},this.command=function(){var t;if(t=this.find()){var t=e(t);this.rte.history.add(),!t.children().length&&!e.trim(t.text()).length?t.remove():t.removeAttr("clear").css("clear","")}else this.rte.history.add(),this.rte.selection.insertNode(e(this.rte.dom.create("div")).css("clear","both").get(0),!0);this.rte.ui.update(!0)},this.update=function(){this.domElem.removeClass("disabled"),this.find()?this.domElem.addClass("active"):this.domElem.removeClass("active")}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.table=function(t,n){function i(){r.labels={main:"Properies",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",dir:"Script direction",summary:"Summary",lang:"Language",href:"URL"},r.src={main:{caption:e('<input type="text" />'),rows:e('<input type="text" />').attr("size",5).val(2),cols:e('<input type="text" />').attr("size",5).val(2),width:e('<input type="text" />').attr("size",5),wunit:e("<select />").append(e("<option />").val("%").text("%")).append(e("<option />").val("px").text("px")),height:e('<input type="text" />').attr("size",5),hunit:e("<select />").append(e("<option />").val("%").text("%")).append(e("<option />").val("px").text("px")),align:e("<select />").append(e("<option />").val("").text(r.rte.i18n("Not set"))).append(e("<option />").val("left").text(r.rte.i18n("Left"))).append(e("<option />").val("center").text(r.rte.i18n("Center"))).append(e("<option />").val("right").text(r.rte.i18n("Right"))),spacing:e('<input type="text" />').attr("size",5),padding:e('<input type="text" />').attr("size",5),border:e("<div />"),rules:e("<select />").append(e("<option />").val("none").text(r.rte.i18n("No"))).append(e("<option />").val("all").text(r.rte.i18n("Cells"))).append(e("<option />").val("groups").text(r.rte.i18n("Groups"))).append(e("<option />").val("rows").text(r.rte.i18n("Rows"))).append(e("<option />").val("cols").text(r.rte.i18n("Columns"))),margin:e("<div />"),bg:e("<div />"),bgimg:e('<input type="text" />').css("width","90%")},adv:{id:e('<input type="text" />'),summary:e('<input type="text" />'),"class":e('<input type="text" />'),style:e('<input type="text" />'),dir:e("<select />").append(e("<option />").text(r.rte.i18n("Not set")).val("")).append(e("<option />").text(r.rte.i18n("Left to right")).val("ltr")).append(e("<option />").text(r.rte.i18n("Right to left")).val("rtl")),lang:e('<input type="text" />')},events:{}},e.each(r.src,function(){for(var e in this){this[e].attr("name",e);var t=this[e].get(0).nodeName;t=="INPUT"&&e!="bgimg"?this[e].css(this[e].attr("size")?{"text-align":"right"}:{width:"100%"}):t=="SELECT"&&e!="wunit"&&e!="hunit"&&this[e].css("width","100%")}}),e.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){r.src.events[this]=e('<input type="text" />').css("width","100%")}),r.src.main.align.change(function(){var t=e(this).val();if(t=="center")r.src.main.margin.val({left:"auto",right:"auto"});else{var n=r.src.main.margin.val();n.left=="auto"&&n.right=="auto"&&r.src.main.margin.val({left:"",right:""})}}),r.src.main.bgimg.change(function(){var t=e(this);t.val(r.rte.utils.absoluteURL(t.val()))})}this.constructor.prototype.constructor.call(this,t,n);var r=this;this.src=null,this.labels=null,this.command=function(){var t=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TABLE$/);this.name=="table"?this.table=e(this.rte.doc.createElement("table")):this.table=t?e(t):e(this.rte.doc.createElement("table")),!this.src&&i(),this.src.main.border.elBorderSelect({styleHeight:117}),this.src.main.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"}),this.src.main.margin.elPaddingInput({type:"margin",value:this.table}),this.table.parents().length?(this.src.main.rows.val("").attr("disabled",!0),this.src.main.cols.val("").attr("disabled",!0)):(this.src.main.rows.val(2).removeAttr("disabled"),this.src.main.cols.val(2).removeAttr("disabled"));var n=this.table.css("width")||this.table.attr("width");this.src.main.width.val(parseInt(n)||""),this.src.main.wunit.val(n.indexOf("px")!=-1?"px":"%");var s=this.table.css("height")||this.table.attr("height");this.src.main.height.val(parseInt(s)||""),this.src.main.hunit.val(s&&s.indexOf("px")!=-1?"px":"%");var o=this.table.css("float");this.src.main.align.val("");if(o=="left"||o=="right")this.src.main.align.val(o);else{var u=this.table.css("margin-left"),f=this.table.css("margin-right");u=="auto"&&f=="auto"&&this.src.main.align.val("center")}this.src.main.border.val(this.table),this.src.main.rules.val(this.rte.dom.attr(this.table.get(0),"rules")),this.src.main.bg.val(this.table.css("background-color"));var l=(this.table.css("background-image")||"").replace(/url\(([^\)]+)\)/i,"$1");this.src.main.bgimg.val(l!="none"?l:"");var c={rtl:this.rte.rtl,submit:function(e,t){e.stopPropagation(),e.preventDefault(),r.set(),t.close()},dialog:{width:530,title:this.rte.i18n("Table")}},h=new elDialogForm(c);for(var p in this.src){h.tab(p,this.rte.i18n(this.labels[p]));if(p=="main"){var d=e("<table />").append(e("<tr />").append("<td>"+this.rte.i18n("Rows")+"</td>").append(e("<td />").append(this.src.main.rows))).append(e("<tr />").append("<td>"+this.rte.i18n("Columns")+"</td>").append(e("<td />").append(this.src.main.cols))),v=e("<table />").append(e("<tr />").append("<td>"+this.rte.i18n("Width")+"</td>").append(e("<td />").append(this.src.main.width).append(this.src.main.wunit))).append(e("<tr />").append("<td>"+this.rte.i18n("Height")+"</td>").append(e("<td />").append(this.src.main.height).append(this.src.main.hunit))),m=e("<table />").append(e("<tr />").append("<td>"+this.rte.i18n("Spacing")+"</td>").append(e("<td />").append(this.src.main.spacing.val(this.table.attr("cellspacing")||"")))).append(e("<tr />").append("<td>"+this.rte.i18n("Padding")+"</td>").append(e("<td />").append(this.src.main.padding.val(this.table.attr("cellpadding")||""))));h.append([this.rte.i18n("Caption"),this.src.main.caption.val(this.table.find("caption").eq(0).text()||"")],"main",!0).separator("main").append([d,v,m],"main",!0).separator("main").append([this.rte.i18n("Border"),this.src.main.border],"main",!0).append([this.rte.i18n("Inner borders"),this.src.main.rules],"main",!0).append([this.rte.i18n("Alignment"),this.src.main.align],"main",!0).append([this.rte.i18n("Margins"),this.src.main.margin],"main",!0).append([this.rte.i18n("Background"),e("<span />").append(e("<span />").css({"float":"left","margin-right":"3px"}).append(this.src.main.bg)).append(this.src.main.bgimg)],"main",!0)}else for(var y in this.src[p]){var w=this.rte.dom.attr(this.table,y);p=="events"&&(w=this.rte.utils.trimEventCallback(w)),h.append([this.rte.i18n(this.labels[y]?this.labels[y]:y),this.src[p][y].val(w)],p,!0)}}h.open()},this.set=function(){if(!this.table.parents().length){var t=parseInt(this.src.main.rows.val())||0,n=parseInt(this.src.main.cols.val())||0;if(t<=0||n<=0)return;this.rte.history.add();var r=e(this.rte.doc.createElement("tbody")).appendTo(this.table);for(var i=0;i<t;i++){var s="<tr>";for(var o=0;o<n;o++)s+="<td>&nbsp;</td>";r.append(s+"</tr>")}}else this.table.removeAttr("width").removeAttr("height").removeAttr("border").removeAttr("align").removeAttr("bordercolor").removeAttr("bgcolor").removeAttr("cellspacing").removeAttr("cellpadding").removeAttr("frame").removeAttr("rules").removeAttr("style");var u=e.trim(this.src.main.caption.val());u?(this.table.children("caption").length||this.table.prepend("<caption />"),this.table.children("caption").text(u)):this.table.children("caption").remove();for(var f in this.src)if(f!="main")for(var l in this.src[f]){var c=e.trim(this.src[f][l].val());c?this.table.attr(l,c):this.table.removeAttr(l)}var h,p,d;(h=parseInt(this.src.main.spacing.val()))&&h>=0&&this.table.attr("cellspacing",h),(p=parseInt(this.src.main.padding.val()))&&p>=0&&this.table.attr("cellpadding",p),(d=this.src.main.rules.val())&&this.table.attr("rules",d);var v=parseInt(this.src.main.width.val())||"",m=parseInt(this.src.main.height.val())||"",i=e.trim(this.src.main.bgimg.val()),r=this.src.main.border.val(),g=this.src.main.margin.val(),y=this.src.main.align.val();this.table.css({width:v?v+this.src.main.wunit.val():"",height:m?m+this.src.main.hunit.val():"",border:e.trim(r.width+" "+r.style+" "+r.color),"background-color":this.src.main.bg.val(),"background-image":i?"url("+i+")":""}),g.css?this.table.css("margin",g.css):this.table.css({"margin-top":g.top,"margin-right":g.right,"margin-bottom":g.bottom,"margin-left":g.left}),(y=="left"||y=="right")&&this.table.css("margin-left")!="auto"&&this.table.css("margin-right")!="auto"&&this.table.css("float",y),this.table.attr("style")||this.table.removeAttr("style"),this.table.parents().length||this.rte.selection.insertNode(this.table.get(0),!0),this.rte.ui.update()},this.update=function(){this.domElem.removeClass("disabled"),this.name=="tableprops"&&!this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TABLE$/)&&this.domElem.addClass("disabled").removeClass("active")}},elRTE.prototype.ui.prototype.buttons.tableprops=elRTE.prototype.ui.prototype.buttons.table}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.tablerm=function(t,n){this.constructor.prototype.constructor.call(this,t,n),this.command=function(){var t=this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/);t&&(this.rte.history.add(),e(t).remove()),this.rte.ui.update(!0)},this.update=function(){this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.tbcellprops=function(t,n){function i(){r.labels={main:"Properies",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",dir:"Script direction",lang:"Language"},r.src={main:{type:e("<select />").css("width","100%").append(e("<option />").val("td").text(r.rte.i18n("Data"))).append(e("<option />").val("th").text(r.rte.i18n("Header"))),width:e('<input type="text" />').attr("size",4),wunit:e("<select />").append(e("<option />").val("%").text("%")).append(e("<option />").val("px").text("px")),height:e('<input type="text" />').attr("size",4),hunit:e("<select />").append(e("<option />").val("%").text("%")).append(e("<option />").val("px").text("px")),align:e("<select />").css("width","100%").append(e("<option />").val("").text(r.rte.i18n("Not set"))).append(e("<option />").val("left").text(r.rte.i18n("Left"))).append(e("<option />").val("center").text(r.rte.i18n("Center"))).append(e("<option />").val("right").text(r.rte.i18n("Right"))).append(e("<option />").val("justify").text(r.rte.i18n("Justify"))),border:e("<div />"),padding:e("<div />"),bg:e("<div />"),bgimg:e('<input type="text" />').css("width","90%"),apply:e("<select />").css("width","100%").append(e("<option />").val("").text(r.rte.i18n("Current cell"))).append(e("<option />").val("row").text(r.rte.i18n("All cells in row"))).append(e("<option />").val("column").text(r.rte.i18n("All cells in column"))).append(e("<option />").val("table").text(r.rte.i18n("All cells in table")))},adv:{id:e('<input type="text" />'),"class":e('<input type="text" />'),style:e('<input type="text" />'),dir:e("<select />").css("width","100%").append(e("<option />").text(r.rte.i18n("Not set")).val("")).append(e("<option />").text(r.rte.i18n("Left to right")).val("ltr")).append(e("<option />").text(r.rte.i18n("Right to left")).val("rtl")),lang:e('<input type="text" />')},events:{}},e.each(r.src,function(){for(var e in this)this[e].attr("name",e),this[e].attr("type")=="text"&&!this[e].attr("size")&&e!="bgimg"&&this[e].css("width","100%")}),e.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){r.src.events[this]=e('<input type="text" />').css("width","100%")})}this.constructor.prototype.constructor.call(this,t,n);var r=this;this.src=null,this.labels=null,this.command=function(){!this.src&&i(),this.cell=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/);if(!this.cell)return;this.src.main.type.val(this.cell.nodeName.toLowerCase()),this.cell=e(this.cell),this.src.main.border.elBorderSelect({styleHeight:117,value:this.cell}),this.src.main.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"}),this.src.main.padding.elPaddingInput({value:this.cell});var t=this.cell.css("width")||this.cell.attr("width");this.src.main.width.val(parseInt(t)||""),this.src.main.wunit.val(t.indexOf("px")!=-1?"px":"%");var n=this.cell.css("height")||this.cell.attr("height");this.src.main.height.val(parseInt(n)||""),this.src.main.hunit.val(n.indexOf("px")!=-1?"px":"%"),this.src.main.align.val(this.cell.attr("align")||this.cell.css("text-align")),this.src.main.bg.val(this.cell.css("background-color"));var s=this.cell.css("background-image");this.src.main.bgimg.val(s&&s!="none"?s.replace(/url\(([^\)]+)\)/i,"$1"):""),this.src.main.apply.val("");var o={rtl:this.rte.rtl,submit:function(e,t){e.stopPropagation(),e.preventDefault(),r.set(),t.close()},dialog:{width:520,title:this.rte.i18n("Table cell properties")}},u=new elDialogForm(o);for(var f in this.src){u.tab(f,this.rte.i18n(this.labels[f]));if(f=="main")u.append([this.rte.i18n("Width"),e("<span />").append(this.src.main.width).append(this.src.main.wunit)],"main",!0).append([this.rte.i18n("Height"),e("<span />").append(this.src.main.height).append(this.src.main.hunit)],"main",!0).append([this.rte.i18n("Table cell type"),this.src.main.type],"main",!0).append([this.rte.i18n("Border"),this.src.main.border],"main",!0).append([this.rte.i18n("Alignment"),this.src.main.align],"main",!0).append([this.rte.i18n("Paddings"),this.src.main.padding],"main",!0).append([this.rte.i18n("Background"),e("<span />").append(e("<span />").css({"float":"left","margin-right":"3px"}).append(this.src.main.bg)).append(this.src.main.bgimg)],"main",!0).append([this.rte.i18n("Apply to"),this.src.main.apply],"main",!0);else for(var l in this.src[f]){var c=this.cell.attr(l)||"";f=="events"&&(c=this.rte.utils.trimEventCallback(c)),u.append([this.rte.i18n(this.labels[l]?this.labels[l]:l),this.src[f][l].val(c)],f,!0)}}u.open()},this.set=function(){var t=this.cell,n=this.src.main.apply.val();switch(this.src.main.apply.val()){case"row":t=this.cell.parent("tr").children("td,th");break;case"column":t=e(this.rte.dom.tableColumn(this.cell.get(0)));break;case"table":t=this.cell.parents("table").find("td,th")}for(var i in this.src)if(i!="main")for(var s in this.src[i]){var o=e.trim(this.src[i][s].val());o?t.attr(s,o):t.removeAttr(s)}t.removeAttr("width").removeAttr("height").removeAttr("border").removeAttr("align").removeAttr("bordercolor").removeAttr("bgcolor");var u=this.src.main.type.val(),f=parseInt(this.src.main.width.val())||"",l=parseInt(this.src.main.height.val())||"",c=e.trim(this.src.main.bgimg.val()),h=this.src.main.border.val(),p={width:f?f+this.src.main.wunit.val():"",height:l?l+this.src.main.hunit.val():"","background-color":this.src.main.bg.val(),"background-image":c?"url("+c+")":"",border:e.trim(h.width+" "+h.style+" "+h.color),"text-align":this.src.main.align.val()||""},d=this.src.main.padding.val();d.css?p.padding=d.css:(p["padding-top"]=d.top,p["padding-right"]=d.right,p["padding-bottom"]=d.bottom,p["padding-left"]=d.left),t=t.get(),e.each(t,function(){var t=this.nodeName.toLowerCase(),n=e(this);if(t!=u){var i={};for(var s in r.src.adv){var o=n.attr(s);o&&(i[s]=o.toString())}for(var s in r.src.events){var o=n.attr(s);o&&(i[s]=o.toString())}var f=n.attr("colspan")||1,l=n.attr("rowspan")||1;f>1&&(i.colspan=f),l>1&&(i.rowspan=l),n.replaceWith(e("<"+u+" />").html(n.html()).attr(i).css(p))}else n.css(p)}),this.rte.ui.update()},this.update=function(){this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.tbcellsmerge=function(t,n){function i(){var t=r.rte.dom.selfOrParent(r.rte.selection.getStart(),/^(TD|TH)$/),n=r.rte.dom.selfOrParent(r.rte.selection.getEnd(),/^(TD|TH)$/);return t&&n&&t!=n&&e(t).parents("table").get(0)==e(n).parents("table").get(0)?[t,n]:null}this.constructor.prototype.constructor.call(this,t,n);var r=this;this.command=function(){var t=i();if(t){var n=this.rte.dom.indexOf(e(t[0]).parent("tr").get(0)),r=this.rte.dom.indexOf(e(t[1]).parent("tr").get(0)),s=Math.min(n,r),o=Math.max(n,r)-s+1,u=this.rte.dom.tableColumn(t[0],!0,!0),f=this.rte.dom.tableColumn(t[1],!0),l=e.inArray(t[0],u.column),c=e.inArray(t[1],f.column),h=u.info.offset[l]<f.info.offset[c]?u:f,p=u.info.offset[l]>=f.info.offset[c]?u:f,d=0,v=null,m="";this.rte.history.add();var g=e(e(t[0]).parents("table").eq(0).find("tr").get().slice(s,s+o)).each(function(t){var n=m.length,r=!1;e(this).children("td,th").each(function(){var n=e(this),i=e.inArray(this,h.column),s=e.inArray(this,p.column);if(i!=-1||s!=-1){r=i!=-1&&s==-1;var o=parseInt(n.attr("colspan")||1);t==0&&(d+=o);if(i!=-1&&t>0){var u=h.info.delta[i];if(u>0){if(n.css("text-align")=="left"){var f=n.clone(!0);n.html("&nbsp;")}else var f=n.clone().html("&nbsp;");f.removeAttr("colspan").removeAttr("id").insertBefore(this),u>1&&f.attr("colspan",u)}}if(s!=-1){var u=p.info.delta[s];if(o-u>1){var l=o-u-1;if(n.css("text-align")=="right"){var f=n.clone(!0);n.html("&nbsp;")}else var f=n.clone().html("&nbsp;");f.removeAttr("colspan").removeAttr("id").insertAfter(this),l>1&&f.attr("colspan",l)}}v?(m+=n.html(),n.remove()):v=n}else r&&(t==0&&(d+=parseInt(n.attr("colspan")||1)),m+=n.html(),n.remove())}),m+=n!=m.length?"<br />":""});v.removeAttr("colspan").removeAttr("rowspan").html(v.html()+m),d>1&&v.attr("colspan",d),o>1&&v.attr("rowspan",o),this.rte.dom.fixTable(e(t[0]).parents("table").get(0))}},this.update=function(){i()?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.tbcellsplit=function(t,n){this.constructor.prototype.constructor.call(this,t,n),this.command=function(){var t=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/);if(t){this.rte.history.add();var n=parseInt(this.rte.dom.attr(t,"colspan")),r=parseInt(this.rte.dom.attr(t,"rowspan"));if(n>1||r>1){var i=n-1,s=r-1,o=this.rte.dom.parent(t,/^TABLE$/),u=this.rte.dom.tableMatrix(o);if(i)for(var f=0;f<i;f++)e(this.rte.dom.create(t.nodeName)).html("&nbsp;").insertAfter(t);if(s){var l=this.rte.dom.indexesOfCell(t,u),c=l[0],h=l[1];for(var p=c+1;p<c+s+1;p++){var d;if(!u[p][h].nodeName){if(u[p][h-1].nodeName)d=u[p][h-1];else for(var f=h-1;f>=0;f--)if(u[p][f].nodeName){d=u[p][f];break}if(d)for(var f=0;f<=i;f++)e(this.rte.dom.create(d.nodeName)).html("&nbsp;").insertAfter(d)}}}e(t).removeAttr("colspan").removeAttr("rowspan"),this.rte.dom.fixTable(o)}}this.rte.ui.update(!0)},this.update=function(){var e=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/);e&&(parseInt(this.rte.dom.attr(e,"colspan"))>1||parseInt(this.rte.dom.attr(e,"rowspan"))>1)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.tbcolbefore=function(t,n){this.constructor.prototype.constructor.call(this,t,n);var r=this;this.command=function(){var t=this,n=this.rte.dom.tableColumn(this.rte.selection.getNode(),!1,!0);n.length&&(this.rte.history.add(),e.each(n,function(){var n=e(this),r=parseInt(n.attr("colspan")||1);if(r>1)n.attr("colspan",r+1);else{var i=e(t.rte.dom.create(this.nodeName)).html("&nbsp;");t.name=="tbcolbefore"?i.insertBefore(this):i.insertAfter(this)}}),this.rte.ui.update())},this.update=function(){this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}},elRTE.prototype.ui.prototype.buttons.tbcolafter=elRTE.prototype.ui.prototype.buttons.tbcolbefore}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.tbcolrm=function(t,n){this.constructor.prototype.constructor.call(this,t,n);var r=this;this.command=function(){var t=this.rte.selection.getNode(),n=this.rte.dom.selfOrParent(t,/^(TD|TH)$/),r=e(n).prev("td,th").get(0),i=e(n).next("td,th").get(0),s=this.rte.dom.parent(t,/^TABLE$/),o=this.rte.dom.tableColumn(t,!1,!0);o.length&&(this.rte.history.add(),e.each(o,function(){var t=e(this),n=parseInt(t.attr("colspan")||1);n>1?t.attr("colspan",n-1):t.remove()}),this.rte.dom.fixTable(s),(r||i)&&this.rte.selection.selectContents(r?r:i).collapse(!0),this.rte.ui.update(!0))},this.update=function(){this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),elRTE.prototype.ui.prototype.buttons.tbrowbefore=function(e,t){this.constructor.prototype.constructor.call(this,e,t),this.command=function(){var e=this.rte.selection.getNode(),t=this.rte.dom.selfOrParent(e,/^(TD|TH)$/),n=this.rte.dom.selfOrParent(t,/^TR$/),r=this.rte.dom.tableMatrix(this.rte.dom.selfOrParent(t,/^TABLE$/));if(t&&n&&r){this.rte.history.add();var i=this.name=="tbrowbefore",s=$(n).prevAll("tr").length,o=0,u=[];function a(e,t){while(t>0){t--;if(r[t]&&r[t][e]&&r[t][e].nodeName)return r[t][e]}}for(var f=0;f<r[s].length;f++)if(r[s][f]&&r[s][f].nodeName){var l=$(r[s][f]),c=parseInt(l.attr("colspan")||1);parseInt(l.attr("rowspan")||1)>1?i?o+=c:u.push(l):o+=c}else r[s][f]=="-"&&(l=a(f,s),l&&u.push($(l)));var h=$(this.rte.dom.create("tr"));for(var f=0;f<o;f++)h.append("<td>&nbsp;</td>");i?h.insertBefore(n):h.insertAfter(n),$.each(u,function(){$(this).attr("rowspan",parseInt($(this).attr("rowspan")||1)+1)}),this.rte.ui.update()}},this.update=function(){this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TR$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}},elRTE.prototype.ui.prototype.buttons.tbrowafter=elRTE.prototype.ui.prototype.buttons.tbrowbefore,function(e){elRTE.prototype.ui.prototype.buttons.tbrowrm=function(t,n){this.constructor.prototype.constructor.call(this,t,n);var r=this;this.command=function(){var t=this.rte.selection.getNode(),n=this.rte.dom.selfOrParent(t,/^(TD|TH)$/),r=this.rte.dom.selfOrParent(n,/^TR$/),i=this.rte.dom.selfOrParent(n,/^TABLE$/),s=this.rte.dom.tableMatrix(i);if(n&&r&&s.length){this.rte.history.add();if(s.length==1)return e(i).remove(),this.rte.ui.update();var o=[],u=e(r).prevAll("tr").length;function f(e,t){while(t>0){t--;if(s[t]&&s[t][e]&&s[t][e].nodeName)return s[t][e]}}function l(t,n){y=u+1;var i=null;if(s[y]){for(var o=0;o<n;o++)s[y][o]&&s[y][o].nodeName&&(i=s[y][o]);t=t.remove(),i?t.insertAfter(i):t.prependTo(e(r).next("tr").eq(0))}}function c(e){for(var t=0;t<e.length;t++)if(e[t]==n)return t<e.length-1?e[t+1]:e[t-1]}for(var h=0;h<s[u].length;h++){var p=null,d=!1;s[u][h]&&s[u][h].nodeName?(p=s[u][h],d=!0):s[u][h]=="-"&&(p=f(h,u))&&(d=!1);if(p){p=e(p);var v=parseInt(p.attr("rowspan")||1);v>1&&(p.attr("rowspan",v-1),d&&l(p,h,u))}}var m=c(this.rte.dom.tableColumn(n));m&&this.rte.selection.selectContents(m).collapse(!0),e(r).remove()}this.rte.ui.update()},this.update=function(){this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TR$/)?this.domElem.removeClass("disabled"):this.domElem.addClass("disabled")}}}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.undo=function(e,t){this.constructor.prototype.constructor.call(this,e,t),this.command=function(){this.name=="undo"&&this.rte.history.canBack()?(this.rte.history.back(),this.rte.ui.update()):this.name=="redo"&&this.rte.history.canFwd()&&(this.rte.history.fwd(),this.rte.ui.update())},this.update=function(){this.domElem.toggleClass("disabled",this.name=="undo"?!this.rte.history.canBack():!this.rte.history.canFwd())}},elRTE.prototype.ui.prototype.buttons.redo=elRTE.prototype.ui.prototype.buttons.undo}(jQuery),function(e){elRTE.prototype.ui.prototype.buttons.unlink=function(t,n){this.constructor.prototype.constructor.call(this,t,n),this.command=function(){function r(e){return e.nodeName=="A"&&e.href}var t=this.rte.selection.getNode(),n=this.rte.dom.selfOrParentLink(t);if(!n){var i=e.browser.msie?this.rte.selection.selected():this.rte.selection.selected({wrap:!1});if(i.length){for(var s=0;s<i.length;s++)if(r(i[s])){n=i[s];break}n||(n=this.rte.dom.parent(i[0],r)||this.rte.dom.parent(i[i.length-1],r))}}n&&(this.rte.history.add(),this.rte.selection.select(n),this.rte.doc.execCommand("unlink",!1,null),this.rte.ui.update(!0))},this.update=function(){var e=this.rte.selection.getNode();this.rte.dom.selfOrParentLink(e)?this.domElem.removeClass("disabled").addClass("active"):this.rte.dom.selectionHas(function(e){return e.nodeName=="A"&&e.href})?this.domElem.removeClass("disabled").addClass("active"):this.domElem.addClass("disabled").removeClass("active")}}}(jQuery);